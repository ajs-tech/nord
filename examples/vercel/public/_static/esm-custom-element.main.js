var xn=Object.create;var Ye=Object.defineProperty;var Un=Object.getOwnPropertyDescriptor;var Hn=Object.getOwnPropertyNames;var Vn=Object.getPrototypeOf,Kn=Object.prototype.hasOwnProperty;var N=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),p=(e,t)=>{for(var r in t)Ye(e,r,{get:t[r],enumerable:!0})},Jn=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Hn(t))!Kn.call(e,n)&&n!==r&&Ye(e,n,{get:()=>t[n],enumerable:!(o=Un(t,n))||o.enumerable});return e};var j=(e,t,r)=>(r=e!=null?xn(Vn(e)):{},Jn(t||!e||!e.__esModule?Ye(r,"default",{value:e,enumerable:!0}):r,e));var R=N(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.toBoolean=ee.isObject=ee.isDefined=void 0;var Wn=e=>e!=null;ee.isDefined=Wn;var zn=e=>typeof e=="object"&&e!==null;ee.isObject=zn;var Gn=e=>e!==!1&&e!==void 0&&e!==null;ee.toBoolean=Gn});var xr=N(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.parseJSONWithDate=Fl;var El=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:.\d{1,3})?Z$/;function Fl(e){return JSON.parse(e,(t,r)=>typeof r=="string"&&r.length===24&&El.test(r)?new Date(r):r)}});var zo=N(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.STRING_TEMPLATE=void 0;var eu=(e,t)=>`{{ ${tu[e]}.${t} }}`;Ce.STRING_TEMPLATE=eu;var tu={cookies:"cookies"}});var Ee=N((Id,Qo)=>{"use strict";Qo.exports=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var o,n,a;if(Array.isArray(t)){if(o=t.length,o!=r.length)return!1;for(n=o;n--!==0;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(a=Object.keys(t),o=a.length,o!==Object.keys(r).length)return!1;for(n=o;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,a[n]))return!1;for(n=o;n--!==0;){var s=a[n];if(!e(t[s],r[s]))return!1}return!0}return t!==t&&r!==r}});var Yo=N(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.safeCustomElementName=void 0;var du=e=>{let t=e.toLocaleLowerCase().replaceAll(" ","");return t.includes("-")?t:`toddle-${t}`};Fe.safeCustomElementName=du});var lo=N(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.isToddleFormula=void 0;var cu=e=>Object.hasOwn(e,"formula");Se.isToddleFormula=cu});var B=N(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.isFormula=Zo;me.isFormulaApplyOperation=fu;me.applyFormula=_;var we=R(),pu=lo();function Zo(e){return e&&typeof e=="object"&&typeof e.type=="string"}function fu(e){return e.type==="apply"}function _(e,t){if(!Zo(e))return e;try{switch(e.type){case"value":return e.value;case"path":{let r=t.data;for(let o of e.path)if(r&&typeof r=="object")r=r[o];else return null;return r}case"switch":{for(let r of e.cases)if((0,we.toBoolean)(_(r.condition,t)))return _(r.formula,t);return _(e.default,t)}case"or":{for(let r of e.arguments)if((0,we.toBoolean)(_(r.formula,t)))return!0;return!1}case"and":{for(let r of e.arguments)if(!(0,we.toBoolean)(_(r.formula,t)))return!1;return!0}case"function":{let r=e.package??t.package,o=(t.toddle??globalThis.toddle)?.getCustomFormula(e.name,r),n=(t.toddle??globalThis.toddle).getFormula(e.name);if((0,we.isDefined)(o)){let a=e.arguments.reduce((s,l,d)=>({...s,[l.name??`${d}`]:l.isFunction?m=>_(l.formula,{...t,data:{...t.data,Args:t.data.Args?{...m,"@toddle.parent":t.data.Args}:m}}):_(l.formula,t)}),{});try{return(0,pu.isToddleFormula)(o)?_(o.formula,{...t,data:{...t.data,Args:a}}):o.handler(a,{root:t.root??document,env:t.env})}catch(s){return t.toddle.errors.push(s),t.env?.logErrors&&console.error(s),null}}else if(typeof n=="function"){let a=(e.arguments??[]).map(s=>s.isFunction?l=>_(s.formula,{...t,data:{...t.data,Args:t.data.Args?{...l,"@toddle.parent":t.data.Args}:l}}):_(s.formula,t));try{return n(a,t)}catch(s){return t.toddle.errors.push(s),t.env?.logErrors&&console.error(s),null}}return t.env?.logErrors&&console.error(`Could not find formula ${e.name} in package ${r??""}`,e),null}case"object":return Object.fromEntries(e.arguments?.map(r=>[r.name,_(r.formula,t)])??[]);case"record":return Object.fromEntries(e.entries.map(r=>[r.name,_(r.formula,t)]));case"array":return e.arguments.map(r=>_(r.formula,t));case"apply":{let r=t.component.formulas?.[e.name];if(!r)return t.env?.logErrors&&console.log("Component does not have a formula with the name ",e.name),null;let o=Object.fromEntries(e.arguments.map(s=>s.isFunction?[s.name,l=>_(s.formula,{...t,data:{...t.data,Args:t.data.Args?{...l,"@toddle.parent":t.data.Args}:l}})]:[s.name,_(s.formula,t)])),n={...t.data,Args:t.data.Args?{...o,"@toddle.parent":t.data.Args}:o},a=t.formulaCache?.[e.name]?.get(n);if(a?.hit)return a.data;{let s=_(r.formula,{...t,data:n});return t.formulaCache?.[e.name]?.set(n,s),s}}default:t.env?.logErrors&&console.error("Could not recognize formula",e)}}catch(r){return t.env?.logErrors&&console.error(r),null}}});var V=N(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.deepSortObject=k.easySort=k.sortObjectEntries=k.set=k.filterObject=k.groupBy=k.omitPaths=k.omitKeys=k.omit=k.mapValues=k.mapObject=k.isObject=void 0;k.get=Xo;var mu=R(),gu=e=>typeof e=="object"&&e!==null;k.isObject=gu;var hu=(e,t)=>Object.fromEntries(Object.entries(e).map(t));k.mapObject=hu;var yu=(e,t)=>(0,k.mapObject)(e,([r,o])=>[r,t(o)]);k.mapValues=yu;var bu=(e,t)=>{let[r,...o]=t,n=Array.isArray(e)?[...e]:(0,k.isObject)(e)?{...e}:{};return o.length===0?delete n[r]:n[r]=(0,k.omit)(n[r],o),n};k.omit=bu;var vu=(e,t)=>Object.fromEntries(Object.entries(e).filter(([r])=>!t.includes(r)));k.omitKeys=vu;var Au=(e,t)=>t.reduce((r,o)=>(0,k.omit)(r,o),{...e});k.omitPaths=Au;var Cu=(e,t)=>e.reduce((r,o)=>{let n=t(o);return r[n]=r[n]??[],r[n].push(o),r},{});k.groupBy=Cu;var Eu=(e,t)=>Object.fromEntries(Object.entries(e).filter(t));k.filterObject=Eu;function Xo(e,[t,...r]){return r.length===0?e?.[t]:Xo(e?.[t],r)}var Fu=(e,t,r)=>{let[o,...n]=t,a=Array.isArray(e)?[...e]:(0,k.isObject)(e)?{...e}:{};return a[o]=n.length===0?r:(0,k.set)(a[o],n,r),a};k.set=Fu;var Su=(e,t,r=!0)=>(0,k.easySort)(Object.entries(e),t,r);k.sortObjectEntries=Su;var wu=(e,t,r=!0)=>[...e].sort((o,n)=>{let a=t(o),s=t(n);return a===s?0:(a>s?1:-1)*(r?1:-1)});k.easySort=wu;var ju=e=>(0,mu.isDefined)(e)?Array.isArray(e)?e.map(t=>(0,k.deepSortObject)(t)):typeof e=="object"&&Object.keys(e).length>0?[...Object.keys(e)].sort().reduce((t,r)=>(t[r]=(0,k.deepSortObject)(e[r]),t),{}):e:e;k.deepSortObject=ju});var en=N(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.hash=void 0;var Ou=(e,t=0)=>{let r=3735928559^t,o=1103547991^t;for(let n=0,a;n<e.length;n++)a=e.charCodeAt(n),r=Math.imul(r^a,2654435761),o=Math.imul(o^a,1597334677);return r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(o^o>>>13,3266489909),o=Math.imul(o^o>>>16,2246822507),o^=Math.imul(r^r>>>13,3266489909),4294967296*(2097151&o)+(r>>>0)};je.hash=Ou});var rn=N(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.ApiMethod=void 0;var tn;(function(e){e.GET="GET",e.POST="POST",e.DELETE="DELETE",e.PUT="PUT",e.PATCH="PATCH",e.HEAD="HEAD",e.OPTIONS="OPTIONS"})(tn||(Oe.ApiMethod=tn={}))});var uo=N(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.functionFormula=K.pathFormula=K.valueFormula=void 0;K.getFormulasInFormula=q;K.getFormulasInAction=ne;var ke=R(),on=B(),ku=lo(),Du=e=>({type:"value",value:e});K.valueFormula=Du;var Ru=e=>({type:"path",path:e});K.pathFormula=Ru;var Tu=(e,t)=>({type:"function",name:e,package:t?.package,arguments:t?.arguments??[],variableArguments:t?.variableArguments});K.functionFormula=Tu;function*q({formula:e,globalFormulas:t,path:r=[],visitedFormulas:o=new Set}){if((0,ke.isDefined)(e))switch(yield[r,e],e.type){case"path":case"value":break;case"record":for(let[n,a]of e.entries.entries())yield*q({formula:a.formula,globalFormulas:t,path:[...r,"entries",n,"formula"],visitedFormulas:o});break;case"function":{let n=[e.package,e.name].filter(ke.isDefined).join("/"),a=!o.has(n);o.add(n);let s=e.package?t.packages?.[e.package]?.formulas?.[e.name]:t.formulas?.[e.name];for(let[l,d]of(e.arguments??[]).entries())yield*q({formula:d.formula,globalFormulas:t,path:[...r,"arguments",l,"formula"],visitedFormulas:o});s&&(0,ku.isToddleFormula)(s)&&a&&(yield*q({formula:s.formula,globalFormulas:t,path:[...r,"formula"],visitedFormulas:o}));break}case"array":case"or":case"and":case"object":for(let[n,a]of(e.arguments??[]).entries())yield*q({formula:a.formula,globalFormulas:t,path:[...r,"arguments",n,"formula"],visitedFormulas:o});break;case"apply":for(let[n,a]of(e.arguments??[]).entries())yield*q({formula:a.formula,globalFormulas:t,path:[...r,"arguments",n,"formula"],visitedFormulas:o});break;case"switch":for(let[n,a]of e.cases.entries())yield*q({formula:a.condition,globalFormulas:t,path:[...r,"cases",n,"condition"],visitedFormulas:o}),yield*q({formula:a.formula,globalFormulas:t,path:[...r,"cases",n,"formula"],visitedFormulas:o});yield*q({formula:e.default,globalFormulas:t,path:[...r,"default"],visitedFormulas:o});break}}function*ne({action:e,globalFormulas:t,path:r=[],visitedFormulas:o=new Set}){if((0,ke.isDefined)(e))switch(e.type){case"Fetch":for(let[n,a]of Object.entries(e.inputs??{}))yield*q({formula:a.formula,globalFormulas:t,path:[...r,"input",n,"formula"],visitedFormulas:o});for(let[n,a]of Object.entries(e.onSuccess?.actions??{}))yield*ne({action:a,globalFormulas:t,path:[...r,"onSuccess","actions",n],visitedFormulas:o});for(let[n,a]of Object.entries(e.onError?.actions??{}))yield*ne({action:a,globalFormulas:t,path:[...r,"onError","actions",n],visitedFormulas:o});for(let[n,a]of Object.entries(e.onMessage?.actions??{}))yield*ne({action:a,globalFormulas:t,path:[...r,"onMessage","actions",n],visitedFormulas:o});break;case"Custom":case void 0:(0,on.isFormula)(e.data)&&(yield*q({formula:e.data,globalFormulas:t,path:[...r,"data"],visitedFormulas:o}));for(let[n,a]of Object.entries(e.arguments??{}))yield*q({formula:a.formula,globalFormulas:t,path:[...r,"arguments",n,"formula"],visitedFormulas:o});for(let[n,a]of Object.entries(e.events??{}))for(let[s,l]of Object.entries(a.actions??{}))yield*ne({action:l,globalFormulas:t,path:[...r,"events",n,"actions",s],visitedFormulas:o});break;case"SetVariable":case"SetURLParameter":case"TriggerEvent":yield*q({formula:e.data,globalFormulas:t,path:[...r,"data"],visitedFormulas:o});break;case"TriggerWorkflow":for(let[n,a]of Object.entries(e.parameters??{}))yield*q({formula:a.formula,globalFormulas:t,path:[...r,"parameters",n,"formula"],visitedFormulas:o});break;case"Switch":(0,ke.isDefined)(e.data)&&(0,on.isFormula)(e.data)&&(yield*q({formula:e.data,globalFormulas:t,path:[...r,"data"],visitedFormulas:o}));for(let[n,a]of e.cases.entries()){yield*q({formula:a.condition,globalFormulas:t,path:[...r,"cases",n,"condition"],visitedFormulas:o});for(let[s,l]of Object.entries(a.actions))yield*ne({action:l,globalFormulas:t,path:[...r,"cases",n,"actions",s],visitedFormulas:o})}for(let[n,a]of Object.entries(e.default.actions))yield*ne({action:a,globalFormulas:t,path:[...r,"default","actions",n],visitedFormulas:o});break}}});var an=N(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.LegacyToddleApi=void 0;var nn=B(),Y=uo(),Nu=R(),co=class{api;key;globalFormulas;_apiReferences;constructor(t,r,o){this.api=t,this.key=r,this.globalFormulas=o}get apiReferences(){if(this._apiReferences)return this._apiReferences;let t=new Set,r=o=>{if((0,Nu.isDefined)(o))switch(o.type){case"path":o.path[0]==="Apis"&&t.add(o.path[1]);break;case"value":break;case"record":o.entries.forEach(n=>r(n.formula));break;case"function":case"array":case"or":case"and":case"apply":case"object":o.arguments?.forEach(n=>r(n.formula));break;case"switch":o.cases.forEach(n=>{r(n.condition),r(n.formula)});break}};return r(this.api.autoFetch),r(this.api.url),Object.values(this.api.path??{}).forEach(o=>r(o.formula)),Object.values(this.api.queryParams??{}).forEach(o=>r(o.formula)),(0,nn.isFormula)(this.api.headers)?r(this.api.headers):Object.values(this.api.headers??{}).forEach(o=>{r(o)}),r(this.api.body),this._apiReferences=t,t}get name(){return this.api.name}get type(){return this.api.type}get autoFetch(){return this.api.autoFetch}get url(){return this.api.url}get path(){return this.api.path}get proxy(){return this.api.proxy}get queryParams(){return this.api.queryParams}get headers(){return this.api.headers}get method(){return this.api.method}get body(){return this.api.body}get auth(){return this.api.auth}get throttle(){return this.api.throttle}get debounce(){return this.api.debounce}get onCompleted(){return this.api.onCompleted}get onFailed(){return this.api.onFailed}*formulasInApi(){let t=this.api,r=this.key;yield*(0,Y.getFormulasInFormula)({formula:t.autoFetch,globalFormulas:this.globalFormulas,path:["apis",r,"autoFetch"]}),yield*(0,Y.getFormulasInFormula)({formula:t.url,globalFormulas:this.globalFormulas,path:["apis",r,"url"]});for(let[o,n]of Object.entries(t.path??{}))yield*(0,Y.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"path",o,"formula"]});for(let[o,n]of Object.entries(t.queryParams??{}))yield*(0,Y.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"queryParams",o,"formula"]});if((0,nn.isFormula)(t.headers))yield*(0,Y.getFormulasInFormula)({formula:t.headers,globalFormulas:this.globalFormulas,path:["apis",r,"headers"]});else for(let[o,n]of Object.entries(t.headers??{}))yield*(0,Y.getFormulasInFormula)({formula:n,globalFormulas:this.globalFormulas,path:["apis",r,"headers",o]});yield*(0,Y.getFormulasInFormula)({formula:t.body,globalFormulas:this.globalFormulas,path:["apis",r,"body"]});for(let[o,n]of Object.entries(t.onCompleted?.actions??{}))yield*(0,Y.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"onCompleted","actions",o]});for(let[o,n]of Object.entries(t.onFailed?.actions??{}))yield*(0,Y.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"onFailed","actions",o]})}};De.LegacyToddleApi=co});var sn=N(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.getActionsInAction=ae;var Pu=R();function*ae(e,t=[]){if((0,Pu.isDefined)(e))switch(yield[t,e],e.type){case"SetVariable":case"SetURLParameter":case"TriggerEvent":case"TriggerWorkflow":break;case"Fetch":for(let[r,o]of Object.entries(e.onSuccess?.actions??{}))yield*ae(o,[...t,"onSuccess","actions",r]);for(let[r,o]of Object.entries(e.onError?.actions??{}))yield*ae(o,[...t,"onError","actions",r]);for(let[r,o]of Object.entries(e.onMessage?.actions??{}))yield*ae(o,[...t,"onMessage","actions",r]);break;case"Custom":case void 0:for(let[r,o]of Object.entries(e.events??{}))for(let[n,a]of Object.entries(o?.actions??{}))yield*ae(a,[...t,"events",r,"actions",n]);break;case"Switch":for(let[r,o]of e.cases.entries())for(let[n,a]of Object.entries(o?.actions??{}))yield*ae(a,[...t,"cases",r,"actions",n]);for(let[r,o]of Object.entries(e.default.actions))yield*ae(o,[...t,"default","actions",r]);break}}});var ln=N(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});Re.ToddleApiV2=void 0;var fo=sn(),L=uo(),Iu=R(),mo=class{api;_apiReferences;key;globalFormulas;constructor(t,r,o){this.api=t,this.key=r,this.globalFormulas=o}get apiReferences(){if(this._apiReferences)return this._apiReferences;let t=new Set,r=o=>{if((0,Iu.isDefined)(o))switch(o.type){case"path":o.path[0]==="Apis"&&t.add(o.path[1]);break;case"value":break;case"record":o.entries.forEach(n=>r(n.formula));break;case"function":case"array":case"or":case"and":case"apply":case"object":o.arguments?.forEach(n=>r(n.formula));break;case"switch":o.cases.forEach(n=>{r(n.condition),r(n.formula)});break}};return r(this.api.autoFetch),r(this.api.url),Object.values(this.api.path??{}).forEach(o=>r(o.formula)),Object.values(this.api.headers??{}).forEach(o=>r(o.formula)),r(this.api.body),Object.values(this.api.inputs).forEach(o=>r(o.formula)),Object.values(this.api.queryParams??{}).forEach(o=>{r(o.formula)}),r(this.api.server?.proxy?.enabled?.formula),r(this.api.server?.ssr?.enabled?.formula),r(this.api.client?.debounce?.formula),Object.values(this.api.redirectRules??{}).forEach(o=>{r(o.formula)}),r(this.api.isError?.formula),r(this.api.timeout?.formula),t.delete(this.key),this._apiReferences=t,t}get version(){return this.api.version}get name(){return this.api.name}get type(){return this.api.type}get autoFetch(){return this.api.autoFetch}get url(){return this.api.url}get path(){return this.api.path}get headers(){return this.api.headers}set headers(t){this.api.headers=t}get method(){return this.api.method}get body(){return this.api.body}get inputs(){return this.api.inputs}get queryParams(){return this.api.queryParams}get server(){return this.api.server}get client(){return this.api.client}get redirectRules(){return this.api.redirectRules}get isError(){return this.api.isError}get timeout(){return this.api.timeout}*formulasInApi(){let t=this.api,r=this.key;for(let[o,n]of Object.entries(this.api.inputs))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"inputs",o,"formula"]});yield*(0,L.getFormulasInFormula)({formula:t.autoFetch,globalFormulas:this.globalFormulas,path:["apis",r,"autoFetch"]}),yield*(0,L.getFormulasInFormula)({formula:t.url,globalFormulas:this.globalFormulas,path:["apis",r,"url"]});for(let[o,n]of Object.entries(t.path??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"path",o,"formula"]});for(let[o,n]of Object.entries(t.queryParams??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"queryParams",o,"formula"]}),yield*(0,L.getFormulasInFormula)({formula:n.enabled,globalFormulas:this.globalFormulas,path:["apis",r,"queryParams",o,"enabled"]});for(let[o,n]of Object.entries(t.headers??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"headers",o,"formula"]}),yield*(0,L.getFormulasInFormula)({formula:n.enabled,globalFormulas:this.globalFormulas,path:["apis",r,"headers",o,"enabled"]});yield*(0,L.getFormulasInFormula)({formula:t.body,globalFormulas:this.globalFormulas,path:["apis",r,"body"]});for(let[o,n]of Object.entries(t.client?.onCompleted?.actions??{}))yield*(0,L.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"client","onCompleted","actions",o]});for(let[o,n]of Object.entries(t.client?.onFailed?.actions??{}))yield*(0,L.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"client","onFailed","actions",o]});yield*(0,L.getFormulasInFormula)({formula:t.client?.debounce?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"client","debounce","formula"]});for(let[o,n]of Object.entries(t.client?.onMessage?.actions??{}))yield*(0,L.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"client","onMessage","actions",o]});for(let[o,n]of Object.entries(t.redirectRules??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"redirectRules",o,"formula"]});yield*(0,L.getFormulasInFormula)({formula:t.isError?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"isError","formula"]}),yield*(0,L.getFormulasInFormula)({formula:t.timeout?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"timeout","formula"]}),yield*(0,L.getFormulasInFormula)({formula:t.server?.proxy?.enabled.formula,globalFormulas:this.globalFormulas,path:["apis",r,"server","proxy","enabled","formula"]}),yield*(0,L.getFormulasInFormula)({formula:t.server?.ssr?.enabled?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"server","ssr","enabled","formula"]})}*actionModelsInApi(){for(let[t,r]of Object.entries(this.api.client?.onCompleted?.actions??{}))yield*(0,fo.getActionsInAction)(r,["apis",this.key,"client","onCompleted","actions",t]);for(let[t,r]of Object.entries(this.api.client?.onFailed?.actions??{}))yield*(0,fo.getActionsInAction)(r,["apis",this.key,"client","onFailed","actions",t]);for(let[t,r]of Object.entries(this.api.client?.onMessage?.actions??{}))yield*(0,fo.getActionsInAction)(r,["apis",this.key,"client","onData","actions",t])}};Re.ToddleApiV2=mo});var Te=N(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.sortApiEntries=D.sortApiObjects=D.createApiEvent=D.isApiError=D.requestHash=D.getBaseUrl=D.getRequestHeaders=D.getRequestQueryParams=D.getRequestPath=D.applyAbortSignal=D.getUrl=D.createApiRequest=D.isLegacyApi=D.NON_BODY_RESPONSE_CODES=void 0;var Z=B(),un=V(),$u=en(),te=R(),se=rn(),dn=an(),Lu=ln();D.NON_BODY_RESPONSE_CODES=[101,204,205,304];var _u=e=>e instanceof dn.LegacyToddleApi?!0:!("version"in e);D.isLegacyApi=_u;var qu=({api:e,formulaContext:t,baseUrl:r,defaultHeaders:o})=>{let n=(0,D.getUrl)(e,t,r),a=Uu({api:e,formulaContext:t,defaultHeaders:o});return{url:n,requestSettings:a}};D.createApiRequest=qu;var Mu=(e,t,r)=>{let o="",n=new URLSearchParams,a,s=(0,Z.applyFormula)(e.url,t);if(["string","number"].includes(typeof s)){let i=typeof s=="number"?String(s):s;try{a=new URL(i,r),o=a.pathname,n=a.searchParams}catch{}}let l=(0,D.getRequestPath)(e.path,t),d=`${o}${l.length>0&&!o.endsWith("/")?"/":""}${l}`,m=new URLSearchParams([...n,...(0,D.getRequestQueryParams)(e.queryParams,t)]),E=[...m.entries()].length>0?`?${m.toString()}`:"";if(a){let i=new URL(a.origin,r);return i.pathname=d,i.search=m.toString(),i}else return new URL(`${d}${E}`,r)};D.getUrl=Mu;var Bu=[se.ApiMethod.POST,se.ApiMethod.DELETE,se.ApiMethod.PUT,se.ApiMethod.PATCH,se.ApiMethod.OPTIONS],xu=(e,t,r)=>{if(e.timeout){let o=(0,Z.applyFormula)(e.timeout.formula,r);typeof o=="number"&&!Number.isNaN(o)&&o>0&&(t.signal=AbortSignal.timeout(o))}};D.applyAbortSignal=xu;var Uu=({api:e,formulaContext:t,defaultHeaders:r})=>{let o=Object.values(se.ApiMethod).includes(e.method)?e.method:se.ApiMethod.GET,n=(0,D.getRequestHeaders)({apiHeaders:e.headers,formulaContext:t,defaultHeaders:r}),a=Gu({api:e,formulaContext:t,headers:n,method:o});n.get("content-type")==="multipart/form-data"&&n.delete("content-type");let s={method:o,headers:n,body:a};return(0,D.applyAbortSignal)(e,s,t),s},Hu=(e,t)=>(0,un.sortObjectEntries)(e??{},([r,o])=>o.index).map(([r,o])=>(0,Z.applyFormula)(o.formula,t)).join("/");D.getRequestPath=Hu;var Vu=(e,t)=>{let r=new URLSearchParams;return Object.entries(e??{}).forEach(([o,n])=>{if(!((0,te.isDefined)(n.enabled)?(0,Z.applyFormula)(n.enabled,t):!0))return;let s=(0,Z.applyFormula)(n.formula,t);if((0,te.isDefined)(s))if(Array.isArray(s))s.forEach(l=>r.append(o,String(l)));else if((0,te.isObject)(s)){let l=(d,m)=>{Object.entries(d).forEach(([E,i])=>{if(!Array.isArray(i)&&(0,te.isObject)(i))return l(i,`${m}[${E}]`);r.set(`${m}[${E}]`,String(i))})};l(s,o)}else r.set(o,String(s))}),r};D.getRequestQueryParams=Vu;var Ku=({apiHeaders:e,formulaContext:t,defaultHeaders:r})=>{let o=new Headers(r);return Object.entries(e??{}).forEach(([n,a])=>{if((0,te.isDefined)(a.enabled)?(0,Z.applyFormula)(a.enabled,t):!0){let l=(0,Z.applyFormula)(a.formula,t);if((0,te.isDefined)(l))try{o.set(n.trim(),(typeof l=="string"?l:String(l)).trim())}catch{}}}),o};D.getRequestHeaders=Ku;var Ju=({origin:e,url:t})=>!(0,te.isDefined)(t)||t===""||t.startsWith("/")?e+t:t;D.getBaseUrl=Ju;var Wu=(e,t)=>(0,$u.hash)(JSON.stringify({url:e.href,method:t.method,headers:(0,un.omitKeys)(Object.fromEntries(Object.entries(t.headers??{})),["host","cookie"]),body:t.body??null}));D.requestHash=Wu;var zu=({apiName:e,response:t,formulaContext:r,errorFormula:o,performance:n})=>{let a=o?(0,Z.applyFormula)(o.formula,{component:r.component,package:r.package,toddle:r.toddle,data:{Attributes:{},Args:r.data.Args,Apis:{[e]:{isLoading:!1,data:t.body,error:null,response:{status:t.status,headers:t.headers,performance:n}}}},env:r.env}):null;return a==null?!t.ok:(0,te.toBoolean)(a)};D.isApiError=zu;var Gu=({api:e,formulaContext:t,headers:r,method:o})=>{if(!e.body||!Bu.includes(o))return;let n=(0,Z.applyFormula)(e.body,t);if(n)switch(r.get("content-type")){case"application/x-www-form-urlencoded":return typeof n=="object"&&n!==null?Object.entries(n).map(([a,s])=>Array.isArray(s)?s.map(l=>`${encodeURIComponent(a)}=${encodeURIComponent(l)}`).join("&"):`${encodeURIComponent(a)}=${encodeURIComponent(String(s))}`).join("&"):"";case"multipart/form-data":{let a=new FormData;return typeof n=="object"&&n!==null&&Object.entries(n).forEach(([s,l])=>{a.set(s,l)}),a}case"text/plain":return String(n);default:return JSON.stringify(n)}},Qu=(e,t)=>new CustomEvent(e,{detail:t});D.createApiEvent=Qu;var cn=(e,t)=>{let r=e.apiReferences.has(t.name),o=t.apiReferences.has(e.name);return r===o?0:r?1:-1},Yu=e=>{let t=new Map,r=(o,n)=>{let a=t.get(n);return a||(a=o.version===2?new Lu.ToddleApiV2(o,n,{formulas:{},packages:{}}):new dn.LegacyToddleApi(o,n,{formulas:{},packages:{}}),t.set(n,a)),a};return[...e].sort(([o,n],[a,s])=>{let l=r(n,o),d=r(s,a);return cn(l,d)})};D.sortApiObjects=Yu;var Zu=e=>[...e].sort(([t,r],[o,n])=>cn(r,n));D.sortApiEntries=Zu});var go=N(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.toValidClassName=ue.getClassName=void 0;var Xu=5381,ed=(e,t)=>{let r=t.length;for(;r;)e=e*33^t.charCodeAt(--r);return e},td=e=>ed(Xu,e),rd=/(a)(d)/gi,Ne=52,pn=e=>String.fromCharCode(e+(e>25?39:97));function od(e){let t="",r;for(r=Math.abs(e);r>Ne;r=r/Ne|0)t=pn(r%Ne)+t;return(pn(r%Ne)+t).replace(rd,"$1-$2")}var nd=e=>od(td(JSON.stringify(e)));ue.getClassName=nd;var ad=(e,t=!1)=>{let r=e.trim().replace(/\s+/g,"-");return t&&(r=r.replace(/[^a-zA-Z0-9-_]/g,o=>`\\${o}`)),/^[^a-zA-Z]/.test(r)&&(r=`_${r}`),r};ue.toValidClassName=ad});var ho=N(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.theme=de.RESET_STYLES=void 0;de.RESET_STYLES=`
@layer reset {
  html {
    height:100%;
  }

  #App {
    height:100%;
    display:flex;
    flex-direction:column;
  }

  body {
    height:100%;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    margin:0;
  }

  [data-node-id]:not([data-unset-toddle-styles],[data-node-type="text"],noscript,br,script,style,math,math *,link,template,meta,title,base), [data-node-id]:not([data-unset-toddle-styles],noscript)::before, [data-node-id]:not([data-unset-toddle-styles],noscript)::after {
    display: flex;
    flex-direction: column;
    flex-grow: 0;
    flex-shrink: 0;

    position: relative;
    box-sizing: border-box;
    padding: 0;
    margin: 0;

    font-size: var(--text-base);
    font-family: var(--font-sans);
    font-weight: var(--font-weight-normal);

    background: transparent;
    color: inherit;
    border: none;
    box-shadow: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(p, h1, h2, h3, h4, h5, h6, label, span, strong, b, i, address, caption, code, cite, dt, dd, em, figcaption, legend, blockquote, abbr, pre, bdo, bdi) {
    display: inline-block;
    overflow-wrap: break-word;
    color: inherit;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(input, button, textarea, select) {
    outline: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(a) {
    color: inherit;
    text-decoration: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(ul, ol, li) {
    list-style: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(span[data-node-type="text"]) {
    font: inherit;
    display: inline;
    flex-direction: column;
    flex-grow: 0;
    flex-shrink: 0;
    box-sizing: border-box;
  }

  [popover]:not(:popover-open):not(dialog[open]) {
    display: revert;
  }
}`;de.theme={colors:{grey:{order:0,variants:{50:{order:0,value:"#FAFAFA"},100:{order:1,value:"#F5F5F5"},200:{order:2,value:"#E5E5E5"},300:{order:3,value:"#D4D4D4"},400:{order:4,value:"#A3A3A3"},500:{order:5,value:"#737373"},600:{order:6,value:"#525252"},700:{order:7,value:"#404040"},800:{order:8,value:"#262626"},900:{order:9,value:"#171717"}}},red:{order:1,variants:{50:{order:0,value:"#FEF2F2"},100:{order:1,value:"#FEE2E2"},200:{order:2,value:"#FECACA"},300:{order:3,value:"#FCA5A5"},400:{order:4,value:"#F87171"},500:{order:5,value:"#EF4444"},600:{order:6,value:"#DC2626"},700:{order:7,value:"#B91C1C"},800:{order:8,value:"#991B1B"},900:{order:9,value:"#7F1D1D"}}},rose:{order:3,variants:{50:{order:0,value:"#FFF1F2"},100:{order:1,value:"#FFE4E6"},200:{order:2,value:"#FECDD3"},300:{order:3,value:"#FDA4AF"},400:{order:4,value:"#FB7185"},500:{order:5,value:"#F43F5E"},600:{order:6,value:"#E11D48"},700:{order:7,value:"#BE123C"},800:{order:8,value:"#9F1239"},900:{order:9,value:"#881337"}}},pink:{order:4,variants:{50:{order:0,value:"#FDF2F8"},100:{order:1,value:"#FCE7F3"},200:{order:2,value:"#FBCFE8"},300:{order:3,value:"#F9A8D4"},400:{order:4,value:"#F472B6"},500:{order:5,value:"#EC4899"},600:{order:6,value:"#DB2777"},700:{order:7,value:"#BE185D"},800:{order:8,value:"#9D174D"},900:{order:9,value:"#831843"}}},amber:{order:5,variants:{50:{order:0,value:"#FFFBEB"},100:{order:1,value:"#FEF3C7"},200:{order:2,value:"#FDE68A"},300:{order:3,value:"#FCD34D"},400:{order:4,value:"#FBBF24"},500:{order:5,value:"#F59E0B"},600:{order:6,value:"#D97706"},700:{order:7,value:"#B45309"},800:{order:8,value:"#92400E"},900:{order:9,value:"#78350F"}}},orange:{order:6,variants:{50:{order:0,value:"#FFF7ED"},100:{order:1,value:"#FFEDD5"},200:{order:2,value:"#FED7AA"},300:{order:3,value:"#FDBA74"},400:{order:4,value:"#FB923C"},500:{order:5,value:"#F97316"},600:{order:6,value:"#EA580C"},700:{order:7,value:"#C2410C"},800:{order:8,value:"#9A3412"},900:{order:9,value:"#7C2D12"}}},yellow:{order:7,variants:{50:{order:0,value:"#FFFBEB"},100:{order:1,value:"#FEF3C7"},200:{order:2,value:"#FDE68A"},300:{order:3,value:"#FCD34D"},400:{order:4,value:"#FBBF24"},500:{order:5,value:"#F59E0B"},600:{order:6,value:"#D97706"},700:{order:7,value:"#B45309"},800:{order:8,value:"#92400E"},900:{order:9,value:"#78350F"}}},lime:{order:8,variants:{50:{order:0,value:"#F7FEE7"},100:{order:1,value:"#ECFCCB"},200:{order:2,value:"#D9F99D"},300:{order:3,value:"#BEF264"},400:{order:4,value:"#A3E635"},500:{order:5,value:"#84CC16"},600:{order:6,value:"#65A30D"},700:{order:7,value:"#4D7C0F"},800:{order:8,value:"#3F6212"},900:{order:9,value:"#365314"}}},green:{order:9,variants:{50:{order:0,value:"#ECFDF5"},100:{order:1,value:"#D1FAE5"},200:{order:2,value:"#A7F3D0"},300:{order:3,value:"#6EE7B7"},400:{order:4,value:"#34D399"},500:{order:5,value:"#10B981"},600:{order:6,value:"#059669"},700:{order:7,value:"#047857"},800:{order:8,value:"#065F46"},900:{order:9,value:"#064E3B"}}},emerald:{order:10,variants:{50:{order:0,value:"#ECFDF5"},100:{order:1,value:"#D1FAE5"},200:{order:2,value:"#A7F3D0"},300:{order:3,value:"#6EE7B7"},400:{order:4,value:"#34D399"},500:{order:5,value:"#10B981"},600:{order:6,value:"#059669"},700:{order:7,value:"#047857"},800:{order:8,value:"#065F46"},900:{order:9,value:"#064E3B"}}},teal:{order:11,variants:{50:{order:0,value:"#F0FDFA"},100:{order:1,value:"#CCFBF1"},200:{order:2,value:"#99F6E4"},300:{order:3,value:"#5EEAD4"},400:{order:4,value:"#2DD4BF"},500:{order:5,value:"#14B8A6"},600:{order:6,value:"#0D9488"},700:{order:7,value:"#0F766E"},800:{order:8,value:"#115E59"},900:{order:9,value:"#134E4A"}}},cyan:{order:12,variants:{50:{order:0,value:"#ECFEFF"},100:{order:1,value:"#CFFAFE"},200:{order:2,value:"#A5F3FC"},300:{order:3,value:"#67E8F9"},400:{order:4,value:"#22D3EE"},500:{order:5,value:"#06B6D4"},600:{order:6,value:"#0891B2"},700:{order:7,value:"#0E7490"},800:{order:8,value:"#155E75"},900:{order:9,value:"#164E63"}}},sky:{order:13,variants:{50:{order:0,value:"#F0F9FF"},100:{order:1,value:"#E0F2FE"},200:{order:2,value:"#BAE6FD"},300:{order:3,value:"#7DD3FC"},400:{order:4,value:"#38BDF8"},500:{order:5,value:"#0EA5E9"},600:{order:6,value:"#0284C7"},700:{order:7,value:"#0369A1"},800:{order:8,value:"#075985"},900:{order:9,value:"#0C4A6E"}}},blue:{order:14,variants:{50:{order:0,value:"#EFF6FF"},100:{order:1,value:"#DBEAFE"},200:{order:2,value:"#BFDBFE"},300:{order:3,value:"#93C5FD"},400:{order:4,value:"#60A5FA"},500:{order:5,value:"#3B82F6"},600:{order:6,value:"#2563EB"},700:{order:7,value:"#1D4ED8"},800:{order:8,value:"#1E40AF"},900:{order:9,value:"#1E3A8A"}}},indigo:{order:15,variants:{50:{order:0,value:"#EEF2FF"},100:{order:1,value:"#E0E7FF"},200:{order:2,value:"#C7D2FE"},300:{order:3,value:"#A5B4FC"},400:{order:4,value:"#818CF8"},500:{order:5,value:"#6366F1"},600:{order:6,value:"#4F46E5"},700:{order:7,value:"#4338CA"},800:{order:8,value:"#3730A3"},900:{order:9,value:"#312E81"}}},purple:{order:16,variants:{50:{order:0,value:"#F5F3FF"},100:{order:1,value:"#EDE9FE"},200:{order:2,value:"#DDD6FE"},300:{order:3,value:"#C4B5FD"},400:{order:4,value:"#A78BFA"},500:{order:5,value:"#8B5CF6"},600:{order:6,value:"#7C3AED"},700:{order:7,value:"#6D28D9"},800:{order:8,value:"#5B21B6"},900:{order:9,value:"#4C1D95"}}},fuchsia:{order:17,variants:{50:{order:0,value:"#FDF4FF"},100:{order:1,value:"#FAE8FF"},200:{order:2,value:"#F5D0FE"},300:{order:3,value:"#F0ABFC"},400:{order:4,value:"#E879F9"},500:{order:5,value:"#D946EF"},600:{order:6,value:"#C026D3"},700:{order:7,value:"#A21CAF"},800:{order:8,value:"#86198F"},900:{order:9,value:"#701A75"}}}},shadow:{sm:{order:0,value:"0 1px 2px 0 rgba(0, 0, 0, 0.25)"},base:{order:1,value:"0 1px 3px 0 rgba(0, 0, 0, 0.25), 0 1px 2px 0 rgba(0, 0, 0, 0.25)"},md:{order:2,value:"0 4px 6px -1px rgba(0, 0, 0, 0.25), 0 2px 4px -1px rgba(0, 0, 0, 0.25)"},lg:{order:3,value:"0 10px 15px -3px rgba(0, 0, 0, 0.25), 0 4px 6px -2px rgba(0, 0, 0, 0.25)"},xl:{order:4,value:"0 20px 25px -5px rgba(0, 0, 0, 0.25), 0 10px 10px -5px rgba(0, 0, 0, 0.25)"},"2xl":{order:5,value:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"}},spacing:.25,fontSize:{lg:{order:0,value:"1.125rem"},sm:{order:1,value:"0.875rem"},xl:{order:2,value:"1.25rem"},xs:{order:3,value:"0.75rem"},"2xl":{order:4,value:"1.5rem"},"3xl":{order:5,value:"1.875rem"},"4xl":{order:6,value:"2.25rem"},"5xl":{order:7,value:"3rem"},xxs:{order:8,value:"0.625rem"},base:{order:9,value:"1rem",default:!0}},fontFamily:{mono:{order:0,value:["Fira Code","monospace"]},sans:{order:1,value:["Inter","sans-serif"],default:!0}},fontWeight:{bold:{order:0,value:"700"},bolder:{order:1,value:"800"},normal:{order:2,value:"500",default:!0},regular:{order:3,value:"400"},"semi-bold":{order:4,value:"600"}},breakpoints:{large:{order:2,value:1440},small:{order:0,value:576},medium:{order:1,value:960}}}});var mn=N(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.getOldThemeCss=ie.getThemeCss=void 0;var fn=ho(),sd=(e,t)=>"breakpoints"in e?(0,ie.getOldThemeCss)(e):`
${t.includeResetStyle?fn.RESET_STYLES:""}

@layer base {
  ${t.createFontFaces?e.fonts.map(r=>`
    ${r.variants.map(o=>`
    @font-face {
      font-family: "${r.family}";
      font-style: ${o.italic?"italic":"normal"};
      font-weight: ${o.weight};
      font-display: auto;
      src: local("${o.url.substring(o.url.lastIndexOf("/")+1)}"), url("${o.url.replace("https://fonts.gstatic.com","/.toddle/fonts/font")}") format("woff2");
    }
    `).join(`
`)}
    `).join(`
`):""}

  body, :host {
    /* Color */
      ${e.color.flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.value};`)).join(`
`)}
  /* Fonts */
    ${e.fonts.map(r=>`--font-${r.name}: '${r.family}',${r.type};`).join(`
`)}

    /* Font size */
    ${e["font-size"].flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Font weight */
    ${e["font-weight"].flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Shadows */
    ${e.shadow.flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Border radius */
    ${e["border-radius"].flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Spacing */
    ${e.spacing.map(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`).join(`
`)).join(`
`)}

    /* Z-index */
    ${e["z-index"].map(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`).join(`
`)).join(`
`)}
  }

  @keyframes animation-spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes animation-fade-in {
    from {
      opacity:0;
    }
    to {
      opacity:1;
    }
  }


  @keyframes animation-fade-out {
    from {
      opacity:1;
    }
    to {
      opacity:0;
    }
  }
}
`;ie.getThemeCss=sd;var id=e=>{let t=Object.entries(e.colors).flatMap(([r,{variants:o}])=>Object.entries(o).map(([n,{value:a}])=>`--${r}-${n}:${a}`));return`




body, :host {
  ${Object.entries(e.fontFamily).map(([r,{value:[o,...n]}])=>`--font-${r}: '${o}',${n.join(",")};`).join(`
`)}

  ${Object.entries(e.fontWeight).map(([r,{value:o}])=>`--font-weight-${r}: ${o};`).join(`
`)}

  ${Object.entries(e.fontSize).map(([r,{value:o}])=>`--font-size-${r}: ${o};`).join(`
`)}

  --spacing:${e.spacing}rem;
    ${t.join(`;
`)};


  --text-xxs:0.625rem;
  --line-height-xxs:0.9rem;

  --text-xs:0.75rem;
  --line-height-xs:1rem;

  --text-sm:0.875rem;
  --line-height-sm:1.25rem;

  --text-base:1rem;
  --line-height-base:1.5rem;

  --text-lg:1.125rem;
  --line-height-lg:1.75rem;

  --text-xl:1.25rem;
  --line-height-xl:1.75rem;

  --text-2xl:1.5rem;
  --line-height-2xl:2rem;

  --text-3xl:1.875rem;
  --line-height-3xl:2.25rem;

  --text-4xl:2.25rem;
  --line-height-4xl:2.5rem;

  --text-5xl:3rem;
  --line-height-5xl:3rem;

  ${Object.entries(e.shadow).map(([r,{value:o}])=>`--shadow-${r}:${o};`).join(`
`)}
}

${fn.RESET_STYLES}

@keyframes animation-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes animation-fade-in {
  from {
    opacity:0;
  }
  to {
    opacity:1;
  }
}


@keyframes animation-fade-out {
  from {
    opacity:1;
  }
  to {
    opacity:0;
  }
}`};ie.getOldThemeCss=id});var gn=N(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.variantSelector=void 0;var ld=e=>[(e.className??e.class)&&`.${e.className}`,(e.evenChild??e["even-child"])&&":nth-child(even)",(e.firstChild??e["first-child"])&&":first-child",(e.focusWithin??e["focus-within"])&&":focus-within",(e.lastChild??e["last-child"])&&":last-child",e.active&&":active",e.autofill&&":is(:-webkit-autofill, :autofill)",e.checked&&":checked",e.disabled&&":disabled",e.empty&&":empty",e.focus&&":focus",e.hover&&":hover",e.invalid&&":invalid",e.link&&":link",e.visited&&":visited",e["first-of-type"]&&":first-of-type",e["focus-visible"]&&":focus-visible",e["last-of-type"]&&":last-of-type",e["popover-open"]&&":popover-open",e.pseudoElement&&`::${e.pseudoElement}`].filter(Boolean).join("");Pe.variantSelector=ld});var vn=N(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.getAllFonts=re.createStylesheet=void 0;re.kebabCase=bn;var ud=V(),yn=R(),hn=go(),dd=mn(),cd=gn(),pd={large:1440,small:576,medium:960};function bn(e){return e.split("").map(t=>"ABCDEFGHIJKLMNOPQRSTYVWXYZ".includes(t)?"-"+t.toLocaleLowerCase():t).join("")}var fd=new Set(["width","min-width","max-width","height","min-height","max-height","margin","margin-top","margin-left","margin-bottom","margin-right","padding","padding-top","padding-left","padding-bottom","padding-right","gap","gap-x","gap-y","border-radius","border-bottom-left-radius","border-bottom-right-radius","border-top-left-radius","border-top-right-radius","border-width","border-top-width","border-left-width","border-bottom-width","border-right-width","font-size","top","right","bottom","left","outline-width"]),md=(e,t,r,o)=>{let n=new Set,a=(0,re.getAllFonts)(t),s=(0,dd.getThemeCss)("breakpoints"in r?{...r,fontFamily:Object.fromEntries(Object.entries(r.fontFamily).filter(([i,f])=>f.default??a.has("--font-"+i)))}:{...r,fonts:r.fonts},o),l=i=>Object.entries(i).map(([f,g])=>{if(!(0,yn.isDefined)(g))return;let b=bn(f),A=String(Number(g))===String(g)&&fd.has(b)?`${Number(g)*4}px`:g;return`${b}:${A};`}).filter(Boolean).join(`
  `),d=(i,f)=>{try{let g=(0,ud.omitKeys)(i.style??{},["variants","breakpoints","shadows"]),b=i.variants??i.style?.variants,A=(S,v,w)=>{let O=Object.entries(v).filter(([c])=>c=="scrollbar-width"),F=l(v);return w?.startingStyle&&(F=`@starting-style {
            ${F}
          }`),`
  ${F.length>0?`${S} {
    ${F}
  }`:""}
      ${O.length>0?`
${S}::-webkit-scrollbar {
  ${O.map(([c,u])=>{switch(u){case"none":return"width: 0;";case"thinn":case"thin":return"width: 4px;";default:return""}}).join(`
`)}
}
`:""}
`};return`
      ${A("."+f,g)}
      ${(b??[]).map(S=>{let v=A(`.${f}${(0,cd.variantSelector)(S)}`,S.style,{startingStyle:S.startingStyle});return S.mediaQuery?`
          @media (${Object.entries(S.mediaQuery).map(([w,O])=>`${w}: ${O}`).filter(Boolean).join(") and (")}) {
            ${v}
          }
          `:S.breakpoint?`
          @media (min-width: ${pd[S.breakpoint]}px) {
            ${v}
          }
          `:v}).join(`
`)}
      `}catch(g){return console.error(g),""}},m=new Set;function E(i,f){if(!m.has(i.name)){if(m.add(i.name),!i.nodes){console.warn("Unable to find nodes for component",i.name);return}Object.entries(i.nodes).forEach(([g,b])=>{if(b.type==="component"){let S=t.find(v=>v.name===[b.package??f,b.name].filter(w=>w).join("/"));if(S){E(S,b.package??f),s+=`
`+d(b,(0,hn.toValidClassName)(`${i.name}:${g}`,!0));return}}if(b.type!=="element")return;let A=(0,hn.getClassName)([b.style,b.variants]);if(n.has(A))return"";n.add(A),s+=`
`+d(b,A)})}}return E(e),s};re.createStylesheet=md;var gd=e=>new Set(e.flatMap(t=>Object.values(t.nodes).flatMap(r=>r.type==="element"?[r.style.fontFamily,r.style["font-family"],...r.variants?.map(o=>o.style.fontFamily??o.style["font-family"])??[]].filter(yn.isDefined):[])).map(t=>t.replace("var(","").replace(")","").replace(/'/g,"")));re.getAllFonts=gd});var Cn=N(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.isImageHeader=x.isJsonStreamHeader=x.isEventStreamHeader=x.isTextHeader=x.isJsonHeader=void 0;var hd=e=>typeof e!="string"?!1:/^application\/(json|.*\+json)/.test(e);x.isJsonHeader=hd;var yd=e=>typeof e!="string"?!1:/^(text\/|application\/x-www-form-urlencoded|application\/(xml|.*\+xml))/.test(e);x.isTextHeader=yd;var bd=e=>typeof e!="string"?!1:/^text\/event-stream/.test(e);x.isEventStreamHeader=bd;var vd=e=>typeof e!="string"?!1:/^(application\/stream\+json|application\/x-ndjson)/.test(e);x.isJsonStreamHeader=vd;var Ad=e=>typeof e!="string"?!1:/^image\//.test(e);x.isImageHeader=Ad});var En=N(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.REWRITE_HEADER=U.PROXY_URL_HEADER=U.validateUrl=U.isLocalhostHostname=U.isLocalhostUrl=void 0;var Cd=["http://localhost:54404","http://preview.localhost:54404"],Ed=e=>Cd.some(t=>e.startsWith(t));U.isLocalhostUrl=Ed;var Fd=e=>e==="localhost"||e==="127.0.0.1";U.isLocalhostHostname=Fd;var Sd=(e,t)=>{if(typeof e!="string")return!1;try{let r=new URL(e,t);return r.searchParams.forEach((o,n)=>{r.searchParams.set(n,o)}),r}catch{return!1}};U.validateUrl=Sd;U.PROXY_URL_HEADER="x-toddle-url";U.REWRITE_HEADER="x-toddle-rewrite"});var gt={};p(gt,{clearLocalStorage:()=>at,clearSessionStorage:()=>pt,copyToClipboard:()=>lt,deleteFromLocalStorage:()=>Xe,deleteFromSessionStorage:()=>st,focus:()=>ct,gotToURL:()=>ft,interval:()=>nt,logToConsole:()=>it,preventDefault:()=>ot,saveToLocalStorage:()=>dt,saveToSessionStorage:()=>rt,setSessionCookies:()=>ut,share:()=>tt,sleep:()=>Ze,stopPropagation:()=>mt});var Ze={};p(Ze,{default:()=>Yn});var ko=j(R()),Qn=([e],t)=>{let r=Number(e);if(!(0,ko.isDefined)(e)||Number.isNaN(e))throw new Error("Invalid delay value");let o=setTimeout(()=>t.triggerActionEvent("tick",null),r);t.abortSignal.addEventListener("abort",()=>{clearTimeout(o)})},Yn=Qn;var Xe={};p(Xe,{default:()=>Xn});var Zn=async function([e]){if(typeof e!="string"||e.length===0)throw new Error(`Invalid key: ${e}`);window.localStorage.removeItem(e)},Xn=Zn;var tt={};p(tt,{default:()=>ta});var et=j(R()),ea=([e,t,r])=>{let o=a=>(0,et.isDefined)(a)&&typeof a=="string";if(!o(e)&&!o(t)&&!o(r))throw new Error("Either url, text or title must be provided");let n={};if(o(t)&&(n.title=t),o(r)&&(n.text=r),o(e)&&(n.url=e),(0,et.isDefined)(navigator.share)&&navigator.canShare(n))return navigator.share(n)},ta=ea;var rt={};p(rt,{default:()=>oa});var ra=async function([e,t]){if(typeof e!="string"||e.length===0)throw new Error(`Invalid key: ${e}`);window.sessionStorage.setItem(e,JSON.stringify(t))},oa=ra;var ot={};p(ot,{default:()=>aa});var na=(e,t,r)=>{r?.preventDefault?.()},aa=na;var nt={};p(nt,{default:()=>ia});var Do=j(R()),sa=([e],t)=>{let r=Number(e);if(!(0,Do.isDefined)(e)||Number.isNaN(e))throw new Error("Invalid delay value");let o=setInterval(()=>t.triggerActionEvent("tick",null),r);t.abortSignal.addEventListener("abort",()=>{clearInterval(o)})},ia=sa;var at={};p(at,{default:()=>ua});var la=async function(){window.localStorage.clear()},ua=la;var st={};p(st,{default:()=>ca});var da=async function([e]){if(typeof e!="string"||e.length===0)throw new Error(`Invalid key: ${e}`);window.sessionStorage.removeItem(e)},ca=da;var it={};p(it,{default:()=>fa});var pa=([e,t])=>{console.log(e,t)},fa=pa;var lt={};p(lt,{default:()=>ga});var ma=([e])=>{if(typeof e!="string")throw new Error("Input value must be a string");return navigator.clipboard.writeText(e)},ga=ma;var ut={};p(ut,{default:()=>ya});var ha=async function([e,t],r){let o=[typeof e=="string"?`name=access_token&value=${encodeURIComponent(e)}`:void 0,isNaN(Number(t))?void 0:`ttl=${t}`].filter(a=>a).join("&"),n=await fetch(`/.toddle/cookies/set-session-cookie?${o}`);n.ok?r.triggerActionEvent("Success",void 0):r.triggerActionEvent("Error",new Error(await n.text()))},ya=ha;var dt={};p(dt,{default:()=>va});var ba=async function([e,t]){if(typeof e!="string"||e.length===0)throw new Error(`Invalid key: ${e}`);window.localStorage.setItem(e,JSON.stringify(t))},va=ba;var ct={};p(ct,{default:()=>Ca});var Aa=([e])=>{e instanceof HTMLElement&&e.focus()},Ca=Aa;var pt={};p(pt,{default:()=>Fa});var Ea=async function(){window.sessionStorage.clear()},Fa=Ea;var ft={};p(ft,{default:()=>wa});var Sa=([e],t)=>{typeof e=="string"&&(t.env.runtime==="preview"?window.parent?.postMessage({type:"blockedNavigation",url:e},"*"):window.location.href=e)},wa=Sa;var mt={};p(mt,{default:()=>Oa});var ja=(e,t,r)=>{r?.stopPropagation?.()},Oa=ja;var io={};p(io,{absolute:()=>mr,add:()=>ao,append:()=>jr,boolean:()=>Xr,branchName:()=>Qt,canShare:()=>Pt,capitalize:()=>to,clamp:()=>Ht,concatenate:()=>Xt,currentURL:()=>Vt,dateFromString:()=>cr,dateFromTimestamp:()=>Wr,decodeBase64:()=>Yt,decodeURIComponent:()=>It,defaultTo:()=>At,deleteKey:()=>hr,divide:()=>dr,drop:()=>xt,dropLast:()=>gr,encodeBase64:()=>Dr,encodeJSON:()=>er,encodeURIComponent:()=>Ot,entries:()=>br,equals:()=>rr,every:()=>qr,filter:()=>qt,find:()=>Mt,findIndex:()=>Gt,findLast:()=>yt,first:()=>ar,flatten:()=>Ar,formatDate:()=>Hr,formatNumber:()=>no,fromEntries:()=>_t,get:()=>lr,getCookie:()=>Zr,getElementById:()=>Wt,getFromLocalStorage:()=>Or,getFromSessionStorage:()=>tr,getHttpOnlyCookie:()=>oo,greaterOrEqueal:()=>so,greaterThan:()=>Lt,groupBy:()=>ir,includes:()=>St,indexOf:()=>eo,isServer:()=>Yr,join:()=>Rr,json:()=>Cr,keyBy:()=>Mr,languages:()=>zr,last:()=>Ut,lastIndexOf:()=>$r,lessOrEqual:()=>Er,lessThan:()=>Pr,lowercase:()=>ro,map:()=>Kt,matches:()=>Vr,max:()=>Nr,min:()=>wt,minus:()=>sr,modulo:()=>Jt,multiply:()=>Ct,not:()=>Tt,notEqual:()=>ht,now:()=>Fr,number:()=>kr,parseJSON:()=>Ur,parseURL:()=>Bt,power:()=>Lr,prepend:()=>ur,randomNumber:()=>Et,range:()=>Tr,reduce:()=>Ft,replaceAll:()=>zt,reverse:()=>nr,round:()=>vt,roundDown:()=>_r,roundUp:()=>Rt,set:()=>$t,shuffle:()=>Ir,size:()=>Qr,some:()=>Dt,sort_by:()=>kt,split:()=>Gr,squareRoot:()=>Sr,startsWith:()=>Jr,string:()=>Zt,sum:()=>Kr,take:()=>wr,takeLast:()=>fr,timestamp:()=>yr,trim:()=>vr,typeOf:()=>pr,unique:()=>or,uppercase:()=>jt,userAgent:()=>bt});var ht={};p(ht,{default:()=>Da});var ka=([e,t])=>!globalThis.toddle.isEqual(e,t),Da=ka;var yt={};p(yt,{default:()=>Ra,getArgumentInputData:()=>Ta,handler:()=>Ro});var Ro=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.findLast((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).findLast(([r,o])=>t({key:r,value:o}))?.[1]:null,Ra=Ro,Ta=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r};var bt={};p(bt,{default:()=>Pa});var Na=(e,{env:t})=>t.isServer?t.request?.headers["user-agent"]??null:window.navigator.userAgent,Pa=Na;var vt={};p(vt,{default:()=>$a});var Ia=([e,t])=>{if(typeof e!="number"||typeof t!="number")return null;let r=Math.max(1,Math.pow(10,t));return Math.round(e*r)/r},$a=Ia;var At={};p(At,{default:()=>_a});var To=j(R()),La=e=>{for(let t of e)if((0,To.toBoolean)(t))return t;return null},_a=La;var Ct={};p(Ct,{default:()=>Ma});var qa=e=>e.some(t=>isNaN(Number(t)))?null:e.reduce((t,r)=>t*r,1),Ma=qa;var Et={};p(Et,{default:()=>xa});var Ba=()=>Math.random(),xa=Ba;var Ft={};p(Ft,{default:()=>Ha,getArgumentInputData:()=>Va});var Ua=([e,t,r])=>typeof t!="function"?null:Array.isArray(e)?e.reduce((o,n,a)=>t({result:o,item:n,index:a}),r):e&&typeof e=="object"?Object.entries(e).reduce((o,[n,a])=>t({result:o,key:n,value:a}),r):null,Ha=Ua,Va=([e,t,r],o,n)=>{if(o!==1)return n;if(Array.isArray(e))return{...n,Args:{item:e[0],index:0,result:r}};if(e&&typeof e=="object"){let[a]=Object.entries(e);if(a)return{...n,Args:{key:a[0],value:a[1],result:r}}}return n};var St={};p(St,{default:()=>Ja});var Ka=([e,t])=>typeof e=="string"&&typeof t=="string"?e.includes(t):Array.isArray(e)?e.some(r=>globalThis.toddle.isEqual(r,t)):null,Ja=Ka;var wt={};p(wt,{default:()=>za});var Wa=e=>Math.min(...e.map(Number)),za=Wa;var jt={};p(jt,{default:()=>Qa});var Ga=([e])=>typeof e!="string"?null:e.toLocaleUpperCase(),Qa=Ga;var Ot={};p(Ot,{default:()=>Za});var Ya=([e])=>typeof e!="string"?null:encodeURIComponent(e),Za=Ya;var kt={};p(kt,{default:()=>es,getArgumentInputData:()=>ts});var Xa=([e,t,r])=>{if(!Array.isArray(e)||typeof t!="function"||typeof r!="boolean")return null;let o=r?1:-1;return[...e].sort((n,a)=>{let s=t({item:n}),l=t({item:a});if(Array.isArray(s)&&Array.isArray(l)){for(let d in s)if(s[d]!==l[d])return(s[d]>l[d]?1:-1)*o;return 0}return s===l?0:(s>l?1:-1)*o})},es=Xa,ts=([e],t,r)=>t===1&&Array.isArray(e)?{...r,Args:{item:e[0]}}:r;var Dt={};p(Dt,{default:()=>rs,getArgumentInputData:()=>os,handler:()=>No});var No=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.some((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).some(([r,o])=>t({key:r,value:o})):null,rs=No,os=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r};var Rt={};p(Rt,{default:()=>as});var ns=([e,t])=>{if(typeof e!="number"||typeof t!="number")return null;let r=Math.max(1,Math.pow(10,t));return Math.ceil(e*r)/r},as=ns;var Tt={};p(Tt,{default:()=>is});var Po=j(R()),ss=([e])=>!(0,Po.toBoolean)(e),is=ss;var Pt={};p(Pt,{default:()=>us});var Nt=j(R()),ls=([e,t,r])=>{if(!(0,Nt.isDefined)(navigator.canShare))return!1;let o=a=>(0,Nt.isDefined)(a)&&typeof a=="string";if(!o(e)&&!o(t)&&!o(r))return!1;let n={};return o(t)&&(n.title=t),o(r)&&(n.text=r),o(e)&&(n.url=e),navigator.canShare(n)},us=ls;var It={};p(It,{default:()=>cs});var ds=([e])=>typeof e!="string"?null:decodeURIComponent(e),cs=ds;var $t={};p($t,{default:()=>ps});var Io=j(R()),$o=([e,t,r],o)=>{if(typeof t!="string"&&typeof t!="number"&&!Array.isArray(t))return null;let[n,...a]=Array.isArray(t)?t:[t];if((0,Io.isObject)(e)){let s=Array.isArray(e)?[...e]:{...e};return s[n]=a.length===0?r:$o([s[n],a,r],o),s}return null},ps=$o;var Lt={};p(Lt,{default:()=>ms});var fs=([e,t])=>e>t,ms=fs;var _t={};p(_t,{default:()=>hs});var gs=([e])=>{if(Array.isArray(e)){let t={};for(let{key:r,value:o}of e)t[r]=o;return t}return null},hs=gs;var qt={};p(qt,{default:()=>ys,getArgumentInputData:()=>bs,handler:()=>Lo});var Lo=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.filter((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.fromEntries(Object.entries(e).filter(([r,o])=>t({key:r,value:o}))):Array.isArray(e)?e.filter((r,o)=>t({item:r,index:o})):null,ys=Lo,bs=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{value:o[1],key:o[0]}}}return r};var Mt={};p(Mt,{default:()=>vs,getArgumentInputData:()=>As,handler:()=>_o});var _o=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.find((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).find(([r,o])=>t({key:r,value:o}))?.[1]:null,vs=_o,As=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r};var Bt={};p(Bt,{default:()=>Es});var Cs=([e,t])=>{if(typeof e!="string")return null;try{let{hostname:r,searchParams:o,pathname:n,hash:a,href:s,protocol:l,port:d,origin:m}=new URL(e,typeof t=="string"?t:void 0);return{hostname:r,searchParams:Object.fromEntries(o),path:n.split("/").filter((E,i)=>i!==0||E!==""),hash:a.replace("#",""),href:s,protocol:l,port:d,origin:m}}catch{return null}},Es=Cs;var xt={};p(xt,{default:()=>Ss});var Fs=([e,t])=>typeof t!="number"||isNaN(t)?null:Array.isArray(e)?e.slice(t):typeof e=="string"?e.substring(t):null,Ss=Fs;var Ut={};p(Ut,{default:()=>js});var ws=([e])=>typeof e=="string"||Array.isArray(e)?e[e.length-1]:null,js=ws;var Ht={};p(Ht,{default:()=>ks});var Os=([e,t,r])=>typeof e!="number"||typeof t!="number"||typeof r!="number"?null:Math.min(Math.max(e,t),r),ks=Os;var Vt={};p(Vt,{default:()=>Rs});var Ds=(e,{env:t})=>t.isServer?t.request.url:window?.location.href??null,Rs=Ds;var Kt={};p(Kt,{default:()=>Ps,getArgumentInputData:()=>Ns});var Ts=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.map((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.fromEntries(Object.entries(e).map(([r,o])=>{let n=t({key:r,value:o});return"key"in n&&"value"in n?[n.key,n.value]:null})):null,Ns=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r},Ps=Ts;var Jt={};p(Jt,{default:()=>$s});var Is=([e,t])=>isNaN(Number(e))||isNaN(Number(t))?null:Number(e)%Number(t),$s=Is;var Wt={};p(Wt,{default:()=>_s});var Ls=([e],{root:t})=>typeof e!="string"?null:t.getElementById(e),_s=Ls;var zt={};p(zt,{default:()=>Ms});var qs=([e,t,r])=>typeof e!="string"||typeof t!="string"?null:e.replaceAll(t,String(r)),Ms=qs;var Gt={};p(Gt,{default:()=>Bs,getArgumentInputData:()=>xs,handler:()=>qo});var qo=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.findIndex((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).findIndex(([r,o])=>t({key:r,value:o})):null,Bs=qo,xs=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r};var Qt={};p(Qt,{default:()=>Hs});var Us=(e,t)=>t.env.branchName,Hs=Us;var Yt={};p(Yt,{default:()=>Ks});var Vs=([e])=>typeof e!="string"?null:atob(e),Ks=Vs;var Zt={};p(Zt,{default:()=>Ws});var Js=([e])=>String(e),Ws=Js;var Xt={};p(Xt,{default:()=>Gs});var Mo=j(R()),zs=e=>{if(e.every(Array.isArray)){let t=[];for(let r of e)t.push(...r);return t}return e.every(Mo.isObject)?Object.assign({},...e):e.join("")},Gs=zs;var er={};p(er,{default:()=>Ys});var Qs=([e,t])=>typeof t!="number"?null:JSON.stringify(e,null,t),Ys=Qs;var tr={};p(tr,{default:()=>Xs});var Zs=([e])=>{if(typeof e!="string"||e.length===0||typeof window>"u")return null;let t=window.sessionStorage.getItem(e);if(t===null)return t;try{return JSON.parse(t)}catch{return t}},Xs=Zs;var rr={};p(rr,{default:()=>ti});var ei=([e,t])=>globalThis.toddle.isEqual(e,t),ti=ei;var or={};p(or,{default:()=>oi});var ri=([e])=>{if(!Array.isArray(e))return null;let t=new Set;return e.filter(r=>{let o=typeof r=="object"?JSON.stringify(r):r;return t.has(o)?!1:(t.add(o),!0)})},oi=ri;var nr={};p(nr,{default:()=>ai});var ni=([e])=>Array.isArray(e)?[...e].reverse():null,ai=ni;var ar={};p(ar,{default:()=>ii});var si=([e])=>typeof e=="string"||Array.isArray(e)?e[0]:null,ii=si;var sr={};p(sr,{default:()=>ui});var li=([e,t])=>{let r=Number(e),o=Number(t);return isNaN(r)||isNaN(o)?null:r-o},ui=li;var ir={};p(ir,{default:()=>di,getArgumentInputData:()=>ci,handler:()=>Bo});var Bo=([e,t])=>{if(typeof t!="function"||!e||typeof e!="object"||!Array.isArray(e))return null;let r={};for(let o in e){let n=e[o],a=String(t({item:n,index:o}));r[a]=r[a]??[],r[a].push(n)}return r},di=Bo,ci=([e],t,r)=>t===1&&Array.isArray(e)?{...r,Args:{item:e[0],index:0}}:r;var lr={};p(lr,{default:()=>fi});var pi=([e,t])=>{if(typeof e=="string")return e[Number(t)];let r=(o,n)=>{if(n.length===0)return o;let[a,...s]=n;return r(o?.[String(a)],s)};return r(e,Array.isArray(t)?t:[t])},fi=pi;var ur={};p(ur,{default:()=>gi});var mi=([e,t])=>Array.isArray(e)?[t,...e]:null,gi=mi;var dr={};p(dr,{default:()=>yi});var hi=([e,t])=>isNaN(Number(e))||isNaN(Number(t))?null:Number(e)/Number(t),yi=hi;var cr={};p(cr,{default:()=>vi});var bi=([e])=>typeof e=="string"?new Date(e):null,vi=bi;var pr={};p(pr,{default:()=>Ci});var Ai=([e])=>{switch(typeof e){case"number":return isNaN(e)?null:"Number";case"string":return"String";case"boolean":return"Boolean";case"object":return Array.isArray(e)?"Array":e===null?"Null":"Object";case"undefined":return"Null";default:return null}},Ci=Ai;var fr={};p(fr,{default:()=>Fi});var Ei=([e,t])=>typeof t!="number"?null:Array.isArray(e)?e.slice(e.length-t):typeof e=="string"?e.substring(e.length-t):null,Fi=Ei;var mr={};p(mr,{default:()=>wi});var Si=([e])=>typeof e!="number"?null:Math.abs(e),wi=Si;var gr={};p(gr,{default:()=>Oi});var ji=([e,t])=>typeof t!="number"||isNaN(t)?null:Array.isArray(e)?e.slice(0,e.length-t):typeof e=="string"?e.substring(0,e.length-t):null,Oi=ji;var hr={};p(hr,{default:()=>Di});var xo=j(R()),ki=([e,t])=>{if(typeof e!="object"||e===null||!Array.isArray(t)&&typeof t!="string"&&typeof t!="number")return null;let r=(n,[a,...s])=>{if(Array.isArray(n)){let l=Number(a);return Number.isNaN(l)?n:s.length===0?n.filter((d,m)=>m!==Number(a)):n.map((d,m)=>m===l?r(n[l],s):d)}return(0,xo.isObject)(n)?s.length===0?Object.fromEntries(Object.entries(n).filter(([l])=>l!==a)):{...n,[a]:r(n[a],s)}:null},o=Array.isArray(t)?t:[t];return r(e,o)},Di=ki;var yr={};p(yr,{default:()=>Ti});var Ri=([e])=>!e||!(e instanceof Date)?null:e.getTime(),Ti=Ri;var br={};p(br,{default:()=>Pi});var Ni=([e])=>typeof e=="object"&&e!==null?Object.entries(e).map(([t,r])=>({key:t,value:r})):null,Pi=Ni;var vr={};p(vr,{default:()=>$i});var Ii=([e])=>typeof e!="string"?null:e.trim(),$i=Ii;var Ar={};p(Ar,{default:()=>_i});var Li=([e])=>Array.isArray(e)?e.flat():null,_i=Li;var Cr={};p(Cr,{default:()=>Mi});var qi=([e,t])=>{let r=isNaN(Number(t))?0:Number(t);return JSON.stringify(e,null,r)},Mi=qi;var Er={};p(Er,{default:()=>xi});var Bi=([e,t])=>e<=t,xi=Bi;var Fr={};p(Fr,{default:()=>Hi});var Ui=()=>new Date,Hi=Ui;var Sr={};p(Sr,{default:()=>Ki});var Vi=([e])=>typeof e!="number"?null:Math.sqrt(e),Ki=Vi;var wr={};p(wr,{default:()=>Wi});var Ji=([e,t])=>typeof t!="number"?null:Array.isArray(e)?e.slice(0,t):typeof e=="string"?e.substring(0,t):null,Wi=Ji;var jr={};p(jr,{default:()=>Gi});var zi=([e,t])=>Array.isArray(e)?[...e,t]:null,Gi=zi;var Or={};p(Or,{default:()=>Yi});var Qi=([e])=>{if(typeof e!="string"||e.length===0||typeof window>"u")return null;let t=window.localStorage.getItem(e);if(t===null)return t;try{return JSON.parse(t)}catch{return t}},Yi=Qi;var kr={};p(kr,{default:()=>Xi});var Zi=([e])=>Number(e),Xi=Zi;var Dr={};p(Dr,{default:()=>tl});var el=([e])=>typeof e!="string"?null:btoa(e),tl=el;var Rr={};p(Rr,{default:()=>ol});var rl=([e,t])=>Array.isArray(e)?e.join(String(t)):null,ol=rl;var Tr={};p(Tr,{default:()=>al});var nl=([e,t])=>typeof e!="number"||typeof t!="number"?null:e>t?[]:Array.from({length:t-e+1},(r,o)=>o+e),al=nl;var Nr={};p(Nr,{default:()=>il});var sl=e=>Math.max(...e.map(Number)),il=sl;var Pr={};p(Pr,{default:()=>ul});var ll=([e,t])=>e<t,ul=ll;var Ir={};p(Ir,{default:()=>cl});var dl=([e])=>Array.isArray(e)?Uo(e):typeof e=="string"?Uo(e.split("")).join(""):null;function Uo(e){let t=[...e];for(let r=t.length-1;r>0;r--){let o=Math.floor(Math.random()*(r+1));[t[r],t[o]]=[t[o],t[r]]}return t}var cl=dl;var $r={};p($r,{default:()=>fl});var pl=([e,t])=>typeof e=="string"?e.lastIndexOf(t):Array.isArray(e)?e.findLastIndex(r=>globalThis.toddle.isEqual(r,t)):null,fl=pl;var Lr={};p(Lr,{default:()=>gl});var ml=([e,t])=>isNaN(Number(e))||isNaN(Number(t))?null:Number(e)**Number(t),gl=ml;var _r={};p(_r,{default:()=>yl});var hl=([e,t])=>{if(typeof e!="number"||typeof t!="number")return null;let r=Math.max(1,Math.pow(10,t));return Math.floor(e*r)/r},yl=hl;var qr={};p(qr,{default:()=>bl,getArgumentInputData:()=>vl,handler:()=>Ho});var Ho=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.every((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).every(([r,o])=>t({key:r,value:o})):null,bl=Ho,vl=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r};var Mr={};p(Mr,{default:()=>Al,getArgumentInputData:()=>Cl,handler:()=>Vo});var Vo=([e,t])=>{if(typeof t!="function"||!e||typeof e!="object")return null;let r=Array.isArray(e)?e:Object.entries(e),o={};for(let n=0;n<r.length;n++){let a=r[n],s=String(t({item:a,i:n}));o[s]=a}return o},Al=Vo,Cl=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{value:o[1],key:o[0]}}}return r};var Ur={};p(Ur,{default:()=>wl});var Ko=j(xr()),Sl=([e])=>{if(typeof e!="string")return null;try{return(0,Ko.parseJSONWithDate)(e)}catch{return null}},wl=Sl;var Hr={};p(Hr,{default:()=>Ol});var jl=([e,t,r])=>{if(!e||!(e instanceof Date))return null;let o=typeof t=="string"&&t.length>0||Array.isArray(t)&&t.every(F=>typeof F=="string")?t:void 0;if(!r||typeof r!="object")return Intl.DateTimeFormat(o).format(e);let n=(F,c)=>typeof F=="string"&&(c?.includes(F)??!0)?F:void 0,a=r,s=n(a.dateStyle,["full","long","medium","short"]),l=n(a.timeStyle,["full","long","medium","short"]),d=n(a.calendar),m=n(a.weekday,["long","short","narrow"]),E=n(a.era,["long","short","narrow"]),i=n(a.year,["numeric","2-digit"]),f=n(a.month,["long","short","narrow","numeric","2-digit"]),g=n(a.day,["numeric","2-digit"]),b=n(a.hour,["numeric","2-digit"]),A=n(a.minute,["numeric","2-digit"]),S=n(a.second,["numeric","2-digit"]),v=n(a.timeZoneName,["long","short","shortOffset","longOffset","shortGeneric","longGeneric"]),w=n(a.timeZone),O=a.hour12===!0?!0:a.hour12===!1?!1:void 0;return Intl.DateTimeFormat(o,{dateStyle:s,timeStyle:l,calendar:d,weekday:m,era:E,year:i,month:f,day:g,hour:b,minute:A,second:S,timeZoneName:v,timeZone:w,hour12:O}).format(e)},Ol=jl;var Vr={};p(Vr,{default:()=>Dl});var Ae=j(R()),kl=([e,t,r,o,n])=>{if(typeof e!="string"||typeof t!="string")return[];let a=[(0,Ae.toBoolean)(r)?"g":"",(0,Ae.toBoolean)(o)?"i":"",(0,Ae.toBoolean)(n)?"m":""].join(""),s=new RegExp(t,a);return e.match(s)??[]},Dl=kl;var Kr={};p(Kr,{default:()=>Tl});var Rl=([e])=>{if(Array.isArray(e)){let t=0;for(let r of e){if(isNaN(r)||typeof r!="number")return null;t+=r}return t}return null},Tl=Rl;var Jr={};p(Jr,{default:()=>Pl});var Nl=([e,t])=>typeof e!="string"||typeof t!="string"?null:e.startsWith(t),Pl=Nl;var Wr={};p(Wr,{default:()=>$l});var Il=([e])=>typeof e=="number"?new Date(e):null,$l=Il;var zr={};p(zr,{default:()=>_l});var Ll=(e,{env:t})=>t.isServer?t.request?.headers["accept-language"]?.split(",").map(r=>r.split(";")[0])??[]:window.navigator.languages,_l=Ll;var Gr={};p(Gr,{default:()=>Ml});var ql=([e,t])=>typeof e!="string"||typeof t!="string"?null:e.split(t),Ml=ql;var Qr={};p(Qr,{default:()=>xl});var Jo=j(R()),Bl=([e])=>Array.isArray(e)?e.length:(0,Jo.isObject)(e)?Object.keys(e).length:typeof e=="string"?e.length:null,xl=Bl;var Yr={};p(Yr,{default:()=>Hl});var Ul=(e,t)=>t.env.isServer,Hl=Ul;var Zr={};p(Zr,{default:()=>Kl});var Vl=([e],{env:t,root:r})=>!e||typeof e!="string"?null:t.isServer?t.request.cookies[e]??null:r instanceof ShadowRoot?null:r.cookie.split("; ")?.find(o=>o.startsWith(`${e}=`))?.split("=")[1]??null,Kl=Vl;var Xr={};p(Xr,{default:()=>Wl});var Wo=j(R()),Jl=([e])=>(0,Wo.toBoolean)(e),Wl=Jl;var eo={};p(eo,{default:()=>Gl});var zl=([e,t])=>typeof e=="string"?e.indexOf(t):Array.isArray(e)?e.findIndex(r=>globalThis.toddle.isEqual(r,t)):null,Gl=zl;var to={};p(to,{default:()=>Yl});var Ql=([e])=>typeof e!="string"?null:e.length===0?e:e[0].toLocaleUpperCase()+e.substring(1).toLocaleLowerCase(),Yl=Ql;var ro={};p(ro,{default:()=>Xl});var Zl=([e])=>typeof e!="string"?null:e.toLocaleLowerCase(),Xl=Zl;var oo={};p(oo,{default:()=>ou});var Go=j(zo()),ru=([e])=>!e||typeof e!="string"?null:(0,Go.STRING_TEMPLATE)("cookies",e),ou=ru;var no={};p(no,{default:()=>au});var nu=([e,t,r])=>{if(typeof e!="number"||Number.isNaN(e))return null;let o=typeof t=="string"&&t.length>0||Array.isArray(t)&&t.every(F=>typeof F=="string")?t:void 0;if(!r||typeof r!="object")return Intl.NumberFormat(o).format(e);let n=(F,c)=>typeof F=="string"&&(c?.includes(F)??!0)?F:void 0,a=r,s=n(a.style,["decimal","currency","percent","unit"]),l=typeof a.currency=="string"&&a.currency.length===3?a.currency:void 0;if(s==="currency"&&typeof l!="string")return null;let d=n(a.currencyDisplay,["code","symbol","narrowSymbol","name"]),m=typeof a.unit=="string"?a.unit:void 0;if(s==="unit"&&typeof m!="string")return null;let E=n(a.unitDisplay,["short","narrow","long"]),i=typeof a.minimumIntegerDigits=="number"&&a.minimumIntegerDigits>=1&&a.minimumIntegerDigits<=21?a.minimumIntegerDigits:void 0,f=typeof a.minimumFractionDigits=="number"&&a.minimumFractionDigits>=0&&a.minimumFractionDigits<=100?a.minimumFractionDigits:void 0,g=typeof a.maximumFractionDigits=="number"&&a.maximumFractionDigits>=0&&a.maximumFractionDigits<=100?a.maximumFractionDigits:void 0,b=typeof a.minimumSignificantDigits=="number"&&a.minimumSignificantDigits>=1&&a.minimumSignificantDigits<=21?a.minimumSignificantDigits:void 0,A=typeof a.maximumSignificantDigits=="number"&&a.maximumSignificantDigits>=1&&a.maximumSignificantDigits<=21?a.maximumSignificantDigits:void 0,S=n(a.notation,["standard","scientific","engineering","compact"]),v=n(a.compactDisplay,["short","long"]),w=["always","auto","min2"],O=typeof a.useGrouping=="boolean"?a.useGrouping:n(a.useGrouping,w);return new Intl.NumberFormat(o,{style:s,currency:l,currencyDisplay:d,unit:m,unitDisplay:E,minimumIntegerDigits:i,minimumFractionDigits:f,maximumFractionDigits:g,minimumSignificantDigits:b,maximumSignificantDigits:A,notation:S,compactDisplay:v,useGrouping:O}).format(e)},au=nu;var ao={};p(ao,{default:()=>iu});var su=e=>!Array.isArray(e)||e.some(t=>t===null||typeof t!="number")?null:e.reduce((t,r)=>t+Number(r),0),iu=su;var so={};p(so,{default:()=>uu});var lu=([e,t])=>e>=t,uu=lu;var Bn=j(Ee());var Mn=j(Yo());var Ge=j(Te()),wo=j(B()),_n=j(vn()),qn=j(ho()),We=j(V());var H=j(B()),An=j(V()),yo=j(xr());var J=j(B()),ce=j(V()),ge=j(R());function I(e,t,r,o){try{if(!e)throw new Error("Action does not exist");switch(e.type){case"Switch":{let n=e.cases.find(({condition:a})=>(0,ge.toBoolean)((0,J.applyFormula)(a,{data:t,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env})))??e.default;if(!n)return;for(let a of n.actions)I(a,{...t,...r.dataSignal.get()},r,o);break}case"SetVariable":{let n=(0,J.applyFormula)(e.data,{data:t,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env});r.dataSignal.update(a=>({...a,Variables:{...a.Variables,[e.variable]:n}}));break}case"TriggerEvent":{let n=(0,J.applyFormula)(e.data,{data:t,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env});r.triggerEvent(e.event,n);break}case"SetURLParameter":{r.toddle.locationSignal.update(n=>{let a=(0,J.applyFormula)(e.data,{data:t,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env});return n.route?.path.some(s=>s.name===e.parameter)?{...n,params:{...(0,ce.omitKeys)(n.params,[e.parameter]),[e.parameter]:a}}:{...n,query:{...(0,ce.omitKeys)(n.query,[e.parameter]),...(0,ge.isDefined)(a)?{[e.parameter]:a}:null}}});break}case"Fetch":{let n=r.apis[e.api];if(!n){console.error("The api ",e.api,"does not exist");return}let a=r.component.apis?.[e.api]?.version===2,s=a?(0,ce.mapValues)(e.inputs??{},m=>(0,J.applyFormula)(m.formula,{data:t,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env})):void 0,l=a?{onCompleted:e.onSuccess?.actions,onFailed:e.onError?.actions,onMessage:e.onMessage?.actions}:void 0,d=m=>{if(!a)for(let E of m)I(E,{...t,...r.dataSignal.get()},r,o)};n.fetch({actionInputs:s,actionModels:l}).then(()=>{d(e.onSuccess.actions)},()=>{d(e.onError.actions)});break}case"TriggerWorkflow":{let n=(0,ce.mapValues)(e.parameters??{},s=>(0,J.applyFormula)(s.formula,{data:t,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env}));if(e.contextProvider){let s=r.providers[[r.package,e.contextProvider].filter(ge.isDefined).join("/")]??r.providers[e.contextProvider],l=s?.component.workflows?.[e.workflow];if(!l){s&&console.warn(`Cannot find workflow "${e.workflow}" on component "${e.contextProvider}". It has likely been removed or modified.`);return}l.actions.forEach(d=>I(d,{...t,...s.ctx.dataSignal.get(),Parameters:n},s.ctx,o));return}let a=r.component.workflows?.[e.workflow];if(!a){console.warn(`Workflow ${e.workflow} does not exist on component ${r.component.name}`);return}a.actions.forEach(s=>I(s,{...t,...r.dataSignal.get(),Parameters:n},r,o));break}default:try{let n=(s,l)=>{let d=e.events?.[s];d&&d.actions.forEach(m=>I(m,l?{...t,...r.dataSignal.get(),Event:l}:{...t,...r.dataSignal.get()},r,l??o))},a=e.version===2?(r.toddle.getCustomAction??r.toddle.getCustomAction)(e.name,e.package??r.package):void 0;if(a){let s=(e.arguments??[]).reduce((d,m)=>({...d,[m.name]:(0,J.applyFormula)(m.formula,{data:t,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env})}),{}),l=a.handler?.(s,{root:r.root,triggerActionEvent:n},o);return l&&(typeof l=="function"||l instanceof Promise)&&r.dataSignal.subscribe(d=>d,{destroy:()=>{l instanceof Promise?l.then(d=>{typeof d=="function"&&d()}).catch(d=>console.error(d)):l()}}),l}else{let s=r.toddle.getAction(e.name);if(!s){console.error("Missing custom action",e.name);return}let l=e.arguments?.map(d=>(0,J.applyFormula)(d.formula,{data:t,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env}))??[(0,J.applyFormula)(e.data,{data:t,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env})];return s(l,{...r,triggerActionEvent:n},o)}}catch(n){console.error("Error in Custom Action",n)}}}catch(n){return console.error(n),null}}function Ie(e,t){let r=null;function o(i,f){let g={data:f,component:t.component,formulaCache:t.formulaCache,root:t.root,package:t.package,toddle:t.toddle,env:t.env},b=(0,H.applyFormula)(i.url,g)??"",A=i.path&&i.path.length>0?"/"+i.path.map(u=>(0,H.applyFormula)(u.formula,g)).join("/"):"",S=Object.values(i.queryParams??{}),v=S.length>0?"?"+S.map(u=>`${u.name}=${encodeURIComponent((0,H.applyFormula)(u.formula,g))}`).join("&"):"",w=(0,H.isFormula)(i.headers)?(0,H.applyFormula)(i.headers,{data:f,component:t.component,formulaCache:t.formulaCache,root:t.root,package:t.package,toddle:t.toddle,env:t.env}):(0,An.mapValues)(i.headers??{},u=>(0,H.applyFormula)(u,{data:f,component:t.component,formulaCache:t.formulaCache,root:t.root,package:t.package,toddle:t.toddle,env:t.env})),O=String(Object.entries(w).find(([u])=>u.toLocaleLowerCase()==="content-type")?.[1]),F=i.method??"GET",c=i.body&&["POST","PUT","PATCH","DELETE"].includes(F)?a((0,H.applyFormula)(i.body,{data:f,component:t.component,formulaCache:t.formulaCache,root:t.root,package:t.package,toddle:t.toddle,env:t.env}),O):void 0;return{url:b+A+v,method:F,auth:i.auth,headers:w,body:c}}async function n(i){let f=await i.text();try{return(0,yo.parseJSONWithDate)(f)}catch{return f}}function a(i,f){switch(f){case"application/x-www-form-urlencoded":return typeof i=="object"&&i!==null?Object.entries(i).map(([g,b])=>Array.isArray(b)?b.map(A=>`${encodeURIComponent(g)}=${encodeURIComponent(A)}`).join("&"):`${encodeURIComponent(g)}=${encodeURIComponent(String(b))}`).join("&"):"";case"multipart/form-data":{let g=new FormData;return typeof i=="object"&&i!==null&&Object.entries(i).forEach(([b,A])=>{g.set(b,A)}),g}case"text/plain":return String(i);default:return JSON.stringify(i)}}function s(i){t.dataSignal.set({...t.dataSignal.get(),Apis:{...t.dataSignal.get().Apis,[e.name]:{data:i,error:null,isLoading:!1}}}),e.onCompleted?.actions?.forEach(f=>{I(f,t.dataSignal.get(),t)})}function l(i){t.dataSignal.set({...t.dataSignal.get(),Apis:{...t.dataSignal.get().Apis,[e.name]:{data:null,isLoading:!1,error:i}}}),e.onFailed?.actions?.forEach(f=>{I(f,t.dataSignal.get(),t)})}async function d(i){t.dataSignal.set({...t.dataSignal.get(),Apis:{...t.dataSignal.get().Apis,[e.name]:{data:t.dataSignal.get().Apis?.[e.name]?.data??null,isLoading:!0,error:null}}});let f;try{e.proxy===!1?f=await fetch(i.url,{method:i.method,headers:i.headers,body:i.body}):f=await fetch(`/_query/${encodeURIComponent(t.component.name)}.${encodeURIComponent(e.name)}`,{method:"POST",body:JSON.stringify(i),signal:t.abortSignal,headers:{"Content-Type":"application/json"}});let g=await n(f);if(f.ok)s(g);else throw g}catch(g){return l(g),Promise.reject(g)}}function m(i){return typeof e.debounce=="number"?new Promise((f,g)=>{typeof r=="number"&&clearTimeout(r),r=setTimeout(()=>{d(i).then(f,g)},e.debounce)}):typeof e.throttle=="number"?typeof r=="number"?new Promise(()=>{}):(r=setTimeout(()=>{typeof r=="number"&&clearTimeout(r)},e.throttle),d(i)):d(i)}let E;if(t.dataSignal.update(i=>({...i,Apis:{...i.Apis??{},[e.name]:i.Apis?.[e.name]??{data:null,isLoading:!!(e.autoFetch&&(0,H.applyFormula)(e.autoFetch,{data:t.dataSignal.get(),component:t.component,formulaCache:t.formulaCache,root:t.root,package:t.package,toddle:t.toddle,env:t.env})),error:null}}})),e.autoFetch){E=t.dataSignal.map(f=>o(e,f));let i=!0;E.subscribe(f=>{if(e.autoFetch&&(0,H.applyFormula)(e.autoFetch,{data:t.dataSignal.get(),component:t.component,formulaCache:t.formulaCache,root:t.root,package:t.package,toddle:t.toddle,env:t.env}))if(i&&t.isRootComponent){i=!1;let g=t.toddle?.pageState?.Apis?.[e.name];g&&g.data?typeof g.data=="string"?s((0,yo.parseJSONWithDate)(g.data)):s(g.data):m(f)}else m(f)})}return{fetch:i=>{let f=o(e,t.dataSignal.get()),g=f.body,b=new Headers({...f.headers,...i?.headers??{}});i?.body&&(g=a(i.body,b.get("Content-Type")??void 0)),g instanceof FormData&&b.delete("Content-Type");let A={url:i?.url??f.url,method:i?.method??f.method,auth:i?.auth??f.auth,headers:[...b.entries()].reduce((S,[v,w])=>({...S,[v]:w}),{}),body:g};return m(A)},destroy:()=>E?.destroy()}}var z=j(Te()),G=j(Cn()),W=j(B()),$e=j(V()),Le=j(En());function _e(e,t){let r=null,o={...e};function n(c){let u=window.origin;try{new URL(u)}catch{u=void 0}return(0,z.createApiRequest)({api:c,formulaContext:a(c),baseUrl:u,defaultHeaders:void 0})}function a(c){let u={data:t.dataSignal.get(),component:t.component,formulaCache:t.formulaCache,root:t.root,package:t.package,toddle:t.toddle,env:t.env},C=Object.entries(c.inputs).reduce((h,[T,$])=>(h[T]=(0,W.applyFormula)($.formula,u),h),{}),y={...u.data,ApiInputs:{...C}};return{component:t.component,formulaCache:t.formulaCache,root:t.root,package:t.package,data:y,toddle:t.toddle,env:t.env}}function s(c){for(let[u,C]of(0,$e.sortObjectEntries)(c.redirectRules??{},([y,h])=>h.index)){let y=(0,W.applyFormula)(C.formula,{...a(c),data:{...a(c).data,Apis:{[c.name]:t.dataSignal.get().Apis?.[c.name]}}});if(typeof y=="string"){let h=(0,Le.validateUrl)(y,window.location.href);if(h){if(t.env.runtime==="preview")return window.parent?.postMessage({type:"blockedNavigation",url:h.href},"*"),{name:u,index:C.index,url:h};window.location.replace(h.href)}}}}function l(c,u,C){switch(c){case"message":{let y=(0,z.createApiEvent)("message",C.body);u.client?.onMessage?.actions?.forEach(h=>{I(h,{...a(u).data,...t.dataSignal.get(),Event:y},t,y)});break}case"success":{let y=(0,z.createApiEvent)("success",C.body);u.client?.onCompleted?.actions?.forEach(h=>{I(h,{...a(u).data,...t.dataSignal.get(),Event:y},t,y)});break}case"failed":{let y=(0,z.createApiEvent)("failed",{error:C.body,status:C.status});u.client?.onFailed?.actions?.forEach(h=>{I(h,{...a(u).data,...t.dataSignal.get(),Event:y},t,y)});break}}}function d(c,u,C){let y=t.dataSignal.get().Apis?.[c.name]?.response?.performance?.requestStart;if(typeof y=="number"&&y>(C.requestStart??0))return;t.dataSignal.set({...t.dataSignal.get(),Apis:{...t.dataSignal.get().Apis,[c.name]:{isLoading:!1,data:u.body,error:null,response:{status:u.status,headers:u.headers,performance:C}}}});let h=s(c);h&&t.dataSignal.set({...t.dataSignal.get(),Apis:{...t.dataSignal.get().Apis,[c.name]:{isLoading:!1,data:u.body,error:null,response:{status:u.status,headers:u.headers,performance:C,...t.env.runtime==="preview"?{debug:{appliedRedirectRule:h}}:{}}}}})}function m(c,u,C){let y=t.dataSignal.get().Apis?.[c.name]?.response?.performance?.requestStart;if(typeof y=="number"&&y>(C.requestStart??0))return;t.dataSignal.set({...t.dataSignal.get(),Apis:{...t.dataSignal.get().Apis,[c.name]:{isLoading:!1,data:null,error:u.body,response:{status:u.status,headers:u.headers,performance:C}}}});let h=s(c);h&&t.dataSignal.set({...t.dataSignal.get(),Apis:{...t.dataSignal.get().Apis,[c.name]:{isLoading:!1,data:null,error:u.body,response:{status:u.status,headers:u.headers,performance:C,...t.env.runtime==="preview"?{debug:{appliedRedirectRule:h}}:{}}}}})}async function E(c,u,C){let y=async()=>{let h={requestStart:Date.now(),responseStart:null,responseEnd:null};t.dataSignal.set({...t.dataSignal.get(),Apis:{...t.dataSignal.get().Apis,[c.name]:{isLoading:!0,data:t.dataSignal.get().Apis?.[c.name]?.data??null,error:null}}});let T;try{if((c.server?.proxy?(0,W.applyFormula)(c.server.proxy.enabled.formula,a(c))??!1:!1)===!1)T=await fetch(u,C);else{let M=`/.toddle/omvej/components/${encodeURIComponent(t.component.name)}/apis/${encodeURIComponent(t.component.name)}:${encodeURIComponent(c.name)}`,P=new Headers(C.headers);P.set(Le.PROXY_URL_HEADER,decodeURIComponent(u.href.replace(/\+/g," "))),C.headers=P,T=await fetch(M,C)}h.responseStart=Date.now(),await i(c,T,h);return}catch($){let M=$.cause?{message:$.message,data:$.cause}:$.message;return m(c,{body:M},{...h,responseEnd:Date.now()}),l("failed",c,{body:M}),Promise.reject($)}};return c.client?.debounce?.formula?new Promise((h,T)=>{typeof r=="number"&&clearTimeout(r),r=setTimeout(()=>{y().then(h,T)},(0,W.applyFormula)(c.client?.debounce?.formula,a(c)))}):y()}function i(c,u,C){let y=c.client?.parserMode??"auto";if(y==="auto"){let h=u.headers.get("content-type");(0,G.isEventStreamHeader)(h)?y="event-stream":(0,G.isJsonHeader)(h)?y="json":(0,G.isTextHeader)(h)?y="text":(0,G.isJsonStreamHeader)(h)?y="json-stream":(0,G.isImageHeader)(h)?y="blob":y="text"}switch(y){case"text":return f(c,u,C);case"json":return b(c,u,C);case"event-stream":return S(c,u,C);case"json-stream":return g(c,u,C);case"blob":return A(c,u,C);default:return f(c,u,C)}}function f(c,u,C){return v({api:c,res:u,performance:C,streamType:"text",useTextDecoder:!0,parseChunk:y=>y,parseChunksForData:y=>y.join("")})}function g(c,u,C){return v({api:c,res:u,performance:C,streamType:"json",useTextDecoder:!0,parseChunk:h=>{let T=h;try{T=JSON.parse(h)}catch{throw new Error("Error occurred while parsing the json chunk.",{cause:T})}return T},parseChunksForData:h=>[...h],delimiters:[`\r
`,`
`]})}async function b(c,u,C){let h={data:await u.json(),isLoading:!1,error:null,response:{status:u.status,headers:Object.fromEntries(u.headers.entries())}};return w(c,h,C)}async function A(c,u,C){let y=await u.blob(),h={isLoading:!1,data:URL.createObjectURL(y),error:null,response:{status:u.status,headers:Object.fromEntries(u.headers.entries())}};return w(c,h,C)}function S(c,u,C){return v({api:c,res:u,performance:C,streamType:"event",useTextDecoder:!0,parseChunk:h=>{let T=h.match(/event: (.*)/)?.[1]??"message",$=h.match(/data: (.*)/)?.[1]??"",M=h.match(/id: (.*)/)?.[1],P=h.match(/retry: (.*)/)?.[1],fe=$;try{fe=JSON.parse($??"")}catch{}return{event:T,data:fe,...M?{id:M}:{},...P?{retry:P}:{}}},parseChunksForData:h=>[...h],delimiters:[`

`,`\r
\r
`]})}async function v({api:c,res:u,performance:C,streamType:y,useTextDecoder:h,parseChunk:T,parseChunksForData:$,delimiters:M}){let P={chunks:[],currentChunk:"",add(X){let Q=T(X);this.chunks.push(Q),Q&&(t.dataSignal.set({...t.dataSignal.get(),Apis:{...t.dataSignal.get().Apis,[c.name]:{isLoading:!0,data:$(this.chunks),error:null,response:{headers:Object.fromEntries(u.headers.entries())}}}}),(c.client?.onMessage?.actions??[]).length>0&&l("message",c,{body:Q}))},processChunk(X){let Q=M?.find(Qe=>X.includes(Qe)),jo=this.currentChunk+X,Oo=Q?jo.split(Q):[jo];this.currentChunk=Oo.pop()??"",Oo.forEach(Qe=>this.add(Qe))}},fe=h?u.body?.pipeThrough(new TextDecoderStream).getReader():u.body?.getReader();for(;fe;){let{done:X,value:Q}=await fe.read();if(X)break;M?P.processChunk(Q):P.add(Q)}P.currentChunk&&P.add(P.currentChunk);let ve={isLoading:!1,data:P.chunks,error:null,response:{status:u.status,headers:Object.fromEntries(u.headers.entries())}};try{if(y==="json"){let X=JSON.parse(P.chunks.join(""));ve.data=X}else y==="text"&&(ve.data=P.chunks.join(""))}catch{throw new Error("Error occurred while parsing the json chunk.",{cause:P.chunks.join("")})}return w(c,ve,C)}function w(c,u,C){C.responseEnd=Date.now();let y={body:u.data,status:u.response?.status,headers:u.response?.headers??void 0};(0,z.isApiError)({apiName:c.name,response:{body:y.body,ok:!!(!u.error&&u.response?.status&&u.response.status<400),status:y.status,headers:y.headers},formulaContext:a(c),errorFormula:c.isError,performance:C})?(!y.body&&u.error&&(y.body=u.error),m(c,y,C),l("failed",c,y)):(d(c,y,C),l("success",c,y))}function O(c){return(0,$e.omitPaths)(c,[["client","onCompleted"],["client","onFailed"],["client","onMessage"],["service"],["server","ssr"]])}let F;return F=t.dataSignal.map(c=>{let u=a(o);return{request:n(o),api:O(o),autoFetch:o.autoFetch?(0,W.applyFormula)(o.autoFetch,u):!1,proxy:(0,W.applyFormula)(o.server?.proxy?.enabled.formula,u)}}),F.subscribe(async c=>{if(o.autoFetch&&(0,W.applyFormula)(o.autoFetch,a(o)))if((window?.__toddle?.isPageLoaded??!1)===!1){let{url:u,requestSettings:C}=n(o),y=(0,z.requestHash)(u,C),h=t.toddle.pageState.Apis?.[y];h?h.error?m(o,{body:h.error,status:h.response?.status,headers:h.response?.headers??void 0},{requestStart:h.response?.performance?.requestStart??null,responseStart:h.response?.performance?.responseStart??null,responseEnd:h.response?.performance?.responseEnd??null}):d(o,{body:h.data,status:h.response?.status,headers:h.response?.headers??void 0},{requestStart:h.response?.performance?.requestStart??null,responseStart:h.response?.performance?.responseStart??null,responseEnd:h.response?.performance?.responseEnd??null}):await E(o,u,C)}else{let{url:u,requestSettings:C}=n(o);await E(o,u,C)}else t.dataSignal.update(u=>({...u,Apis:{...u.Apis??{},[o.name]:{isLoading:!1,data:null,error:null}}}))}),{fetch:({actionInputs:c,actionModels:u})=>{let C=Object.entries(c??{}).reduce(($,[M,P])=>(P!==null&&typeof P=="object"&&"formula"in P?$[M]=P:$[M]={formula:{type:"value",value:P}},$),{}),y={...o,inputs:{...o.inputs,...C},client:{...o.client,parserMode:o.client?.parserMode??"auto",onCompleted:{trigger:o.client?.onCompleted?.trigger??"success",actions:[...o.client?.onCompleted?.actions??[],...u?.onCompleted??[]]},onFailed:{trigger:o.client?.onFailed?.trigger??"failed",actions:[...o.client?.onFailed?.actions??[],...u?.onFailed??[]]},onMessage:{trigger:o.client?.onMessage?.trigger??"message",actions:[...o.client?.onMessage?.actions??[],...u?.onMessage??[]]}}},{url:h,requestSettings:T}=n(y);return E(y,h,T)},update:c=>{o=c;let u=a(o),C=o.autoFetch&&(0,W.applyFormula)(o.autoFetch,u);C&&F?.set({request:n(c),api:O(c),autoFetch:C,proxy:(0,W.applyFormula)(c.server?.proxy?.enabled.formula,u)})},triggerActions:()=>{let c=t.dataSignal.get().Apis?.[o.name];c===void 0||c.data===null&&c.error===null||(c.error?l("failed",o,{body:c.error,status:c.response?.status}):l("success",o,{body:c.data}))},destroy:()=>F?.destroy()}}var Ln=j(Ee());var qe=class{batchQueue=[];isProcessing=!1;processBatch(){this.isProcessing||(this.isProcessing=!0,requestAnimationFrame(()=>{for(;this.batchQueue.length>0;)this.batchQueue.shift()?.();this.isProcessing=!1}))}add(t){this.batchQueue.push(t),this.processBatch()}};var Je=j(B()),$n=j(R());var vo=j(Ee()),bo=class{value;subscribers;subscriptions;constructor(t){this.value=t,this.subscribers=new Set,this.subscriptions=[]}get(){return this.value}set(t){if(this.subscribers.size===0){this.value=t;return}(0,vo.default)(t,this.value)===!1&&(this.value=t,this.subscribers.forEach(({notify:r})=>r(this.value)))}update(t){this.set(t(this.value))}subscribe(t,r){let o={notify:t,destroy:r?.destroy};return this.subscribers.add(o),t(this.value),()=>{this.subscribers.delete(o)}}destroy(){this.subscribers.forEach(({destroy:t})=>{t?.()}),this.subscribers.clear(),this.subscriptions?.forEach(t=>t())}cleanSubscribers(){this.subscribers.forEach(({destroy:t})=>{t?.()}),this.subscribers.clear()}map(t){let r=oe(t(this.value));return r.subscriptions.push(this.subscribe(o=>r.set(t(o)),{destroy:()=>r.destroy()})),r}};function oe(e){return new bo(e)}typeof window<"u"&&(window.signal=oe,window.deepEqual=vo.default);var Ao=(e,t)=>{let o=e.split(".").slice(-1)[0],n=parseInt(o),a=parseInt(String(o.split("(")[1]));for(let s of t.children){let d=s.getAttribute("data-id")?.split(".").slice(-1)[0],m=parseInt(String(d));if(m===n&&parseInt(String(d?.split("(")[1]))>a||m>n)return s}return null};function Fn(e,t,r=null){let o=r,n=o?o.previousSibling:e.lastChild;for(let a=t.length-1;a>=0;a--){let s=t[a];s===n?n=s.previousSibling:e.insertBefore(s,o),o=s}}var Ue=j(Te()),ye=j(B()),xe=j(V()),kn=j(R());var Me=e=>e.formulas&&Object.values(e.formulas).some(({exposeInContext:t})=>t)||e.workflows&&Object.values(e.workflows).some(({exposeInContext:t})=>t);var Co=j(B()),Be=j(V()),Eo=j(R());function Sn(e,t,r){Object.entries(t.contexts??{}).forEach(([o,n])=>{let a=r.providers[[r.package,o].filter(Eo.isDefined).join("/")];if(a)n.formulas.forEach(s=>{let l=a.formulaDataSignals[s];if(!l){console.warn(`Provider ${o} does not expose a formula named "${s}". Available formulas are: ["${Object.keys(a.formulaDataSignals).join('", "')}"]`);return}l.subscribe(d=>{e.update(m=>({...m,Contexts:{...m.Contexts,[o]:{...m.Contexts?.[o],[s]:d}}}))})});else if(!a&&r.env.runtime==="preview"&&r.toddle._preview){let s=r.components?.find(m=>m.name===[r.package,o].filter(Eo.isDefined).join("/"));if(!s){console.error(`Could not find provider "${o}". No such component exist.`);return}let[,l]=o.split("/").reverse(),d={data:{Attributes:(0,Be.mapObject)(s.attributes,([m,E])=>[m,E.testValue])},component:s,root:r?.root,formulaCache:{},package:l??r?.package,toddle:r.toddle,env:r.env};s.route&&(d.data["URL parameters"]={...Object.fromEntries(s.route.path.filter(m=>m.type==="param").map(m=>[m.name,m.testValue])),...(0,Be.mapObject)(s.route.query,([m,{testValue:E}])=>[m,E])}),d.data.Variables=(0,Be.mapObject)(s.variables,([m,E])=>[m,(0,Co.applyFormula)(E.initialValue,d)]),e.update(m=>({...m,Contexts:{...m.Contexts,[o]:Object.fromEntries(n.formulas.map(E=>{let i=s.formulas?.[E];return i?[E,(0,Co.applyFormula)(i.formula,d)]:(console.warn(`Could not find formula "${E}" in component "${o}"`),[E,null])}))}}))}})}function wn(e,t){window.__components||(window.__components={}),window.__components[e.name]=t}var he=j(V()),jn=j(R());function On(e){return(0,jn.isDefined)(e.formulas)?(0,he.mapObject)(e.formulas,([t,r])=>{let{canCache:o,keys:n}=r.memoize?wd(r.formula,e):{canCache:!1,keys:[]},a,s;return[t,{get:l=>o&&a&&n.every(d=>(0,he.get)(l,d)===(0,he.get)(a,d))?{hit:!0,data:s}:{hit:!1},set:(l,d)=>{o&&(a=l,s=d)}}]}):{}}function wd(e,t){let r=[];function o(a){if(a&&(a.type=="path"&&a.path[0]!=="Args"&&r.push(a.path),Array.isArray(a?.arguments)&&a?.arguments.forEach(s=>o(s.formula)),a.type==="record"&&Array.isArray(a.entries)&&a.entries.forEach(s=>o(s.formula)),a.type==="apply")){if(!t.formulas?.[a.name]?.memoize)throw new Error("Cannot memoize");o(t.formulas?.[a.name]?.formula)}}try{o(e)}catch{return{canCache:!1,keys:[]}}let n=[];return r.sort((a,s)=>a.length-s.length).forEach(a=>{n.some(s=>s.every((l,d)=>l===a[d]))||n.push(a)}),{canCache:!0,keys:n}}function Dn({node:e,path:t,dataSignal:r,ctx:o,parentElement:n,instance:a,namespace:s}){let l=[o.package,e.name].filter(kn.isDefined).join("/"),d=o.components?.find(v=>v.name===l);if(!d)return console.warn(`Could not find component "${l}" for component "${o.component.name}". Available components are: ["${o.components.map(v=>v.name).join('", "')}"]`),[];let m=r.map(v=>(0,xe.mapObject)(e.attrs,([w,O])=>[w,O?.type!=="value"?(0,ye.applyFormula)(O,{data:v,component:o.component,formulaCache:o.formulaCache,root:o.root,package:o.package,toddle:o.toddle,env:o.env}):O?.value])),E=oe({Location:r.get().Location,Attributes:m.get(),Apis:(0,xe.mapObject)(d.apis,([v,w])=>[v,{data:null,isLoading:!!(w.autoFetch&&(0,ye.applyFormula)(w.autoFetch,{data:r.get(),component:d,formulaCache:o.formulaCache,root:o.root,package:o.package,toddle:o.toddle,env:o.env})),error:null}])});Sn(E,d,o),E.update(v=>({...v,Variables:(0,xe.mapObject)(d.variables,([w,O])=>[w,(0,ye.applyFormula)(O.initialValue,{data:E.get(),component:d,formulaCache:o.formulaCache,root:o.root,package:o.package,toddle:o.toddle,env:o.env})])})),wn(d,E);let i=new AbortController;E.subscribe(()=>{},{destroy:()=>i.abort(`Component ${d.name} unmounted`)});let f=On(d),g={};(0,Ue.sortApiObjects)(Object.entries(d.apis)).forEach(([v,w])=>{(0,Ue.isLegacyApi)(w)?g[v]=Ie(w,{...o,apis:g,component:d,dataSignal:E,abortSignal:i.signal,isRootComponent:!1,formulaCache:f,package:e.package??o.package,triggerEvent:(O,F)=>{let c=Object.values(e.events).find(u=>u.trigger===O);c&&c.actions.forEach(u=>I(u,{...r.get(),Event:F},o))}}):g[v]=_e(w,{...o,apis:g,component:d,dataSignal:E,abortSignal:i.signal,isRootComponent:!1,formulaCache:f,package:e.package??o.package,triggerEvent:(O,F)=>{let c=Object.values(e.events).find(u=>u.trigger===O);c&&c.actions.forEach(u=>I(u,{...r.get(),Event:F},o))}})}),Object.values(g).filter(v=>v.triggerActions!==void 0).forEach(v=>{v.triggerActions()});let b=(v,w)=>{let O=Object.values(e.events).find(F=>F.trigger===v);O&&O.actions.forEach(F=>I(F,{...r.get(),Event:w},o))},A=o.providers;if(Me(d)){let v=Object.fromEntries(Object.entries(d.formulas??{}).filter(([,w])=>w.exposeInContext).map(([w,O])=>[w,E.map(F=>(0,ye.applyFormula)(O.formula,{data:F,component:d,formulaCache:o.formulaCache,root:o.root,package:o.package,toddle:o.toddle,env:o.env}))]));A={...A,[d.name]:{component:d,formulaDataSignals:v,ctx:{...o,apis:g,component:d,dataSignal:E,abortSignal:i.signal,triggerEvent:b}}}}let S={};for(let v=0;v<e.children.length;v++){let w=e.children[v],F=o.component.nodes[w].slot??"default";S[F]=S[F]??[],S[F].push({id:w,path:`${t}.${v}[${F}]`,dataSignal:r,ctx:{...o,package:e.package??o.package}})}return m.subscribe(v=>E.update(w=>({...w,Attributes:v})),{destroy:()=>E.destroy()}),He({dataSignal:E,component:d,components:o.components,path:t,root:o.root,isRootComponent:!1,children:S,formulaCache:f,providers:A,apis:g,abortSignal:i.signal,package:e.package??o.package,parentElement:n,onEvent:b,toddle:o.toddle,env:o.env,namespace:s,instance:e.id==="root"?{...a,[o.component.name]:"root"}:{[o.component.name]:e.id??""}})}var be=j(B()),Ve=j(go()),Ke=j(R());function Rn(e){if(e instanceof DragEvent)return Array.from(e.dataTransfer?.items??[]).reduce((t,r)=>(t[r.type]=e.dataTransfer?.getData(r.type),t),{})}function Tn(e,t,r){return t.component.version===2&&r==="root"?`${t.package??t.toddle.project}-${e.tag}`:e.tag}var pe=j(R());function Fo(e,t,r){switch(t){case"srcObject":case"src":e instanceof HTMLMediaElement?e[t]=r:e.setAttribute(t,String(r));break;case"value":case"type":{let o=r;e instanceof HTMLProgressElement&&(!(0,pe.isDefined)(r)||!Number.isFinite(Number(r)))&&(o=0),e[t]=(0,pe.toBoolean)(o)?String(o):void 0;break}case"muted":case"autoplay":e instanceof HTMLMediaElement?e[t]=(0,pe.toBoolean)(r):e.setAttribute(t,String(r));break;default:(0,pe.toBoolean)(r)?(e.setAttribute(t,String(r)),t==="autofocus"&&document.body.getAttribute("data-mode")!=="design"&&setTimeout(()=>e.focus(),100)):e.removeAttribute(t)}}function Nn({node:e,dataSignal:t,id:r,path:o,ctx:n,namespace:a,instance:s}){let l=Tn(e,n,r);switch(l){case"svg":{a="http://www.w3.org/2000/svg";break}case"math":{a="http://www.w3.org/1998/Math/MathML";break}}e.attrs.xmlns&&e.attrs.xmlns.type==="value"&&(a=String(e.attrs.xmlns.value));let d=a?document.createElementNS(a,l):document.createElement(l);d.setAttribute("data-node-id",r),o&&d.setAttribute("data-id",o),n.isRootComponent===!1&&r!=="root"&&d.setAttribute("data-component",n.component.name);let m=(0,Ve.getClassName)([e.style,e.variants]);d.classList.add(m),s&&r==="root"&&Object.entries(s).forEach(([i,f])=>{d.classList.add((0,Ve.toValidClassName)(`${i}:${f}`))}),e.classes&&Object.entries(e.classes)?.forEach(([i,{formula:f}])=>{f?t.map(b=>(0,Ke.toBoolean)((0,be.applyFormula)(f,{data:b,component:n.component,formulaCache:n.formulaCache,root:n.root,package:n.package,toddle:n.toddle,env:n.env}))).subscribe(b=>b?d.classList.add(i):d.classList.remove(i)):d.classList.add(i)}),Object.entries(e.attrs).forEach(([i,f])=>{if(!(0,Ke.isDefined)(f))return;let g,b=()=>{f.type==="value"?Fo(d,i,f?.value):(g=t.map(A=>(0,be.applyFormula)(f,{data:A,component:n.component,formulaCache:n.formulaCache,root:n.root,package:n.package,toddle:n.toddle,env:n.env})),g.subscribe(A=>{Fo(d,i,A)}))};i==="autofocus"&&n.env.runtime==="preview"&&n.toddle._preview?n.toddle._preview.showSignal.subscribe(({testMode:A})=>{A?b():(g?.destroy(),d.removeAttribute(i))}):b()}),e["style-variables"]?.forEach(({formula:i,name:f,unit:g})=>{t.map(A=>{let S=(0,be.applyFormula)(i,{data:A,component:n.component,formulaCache:n.formulaCache,root:n.root,package:n.package,toddle:n.toddle,env:n.env});return g?S+g:S}).subscribe(A=>d.style.setProperty(`--${f}`,A))}),Object.values(e.events).forEach(i=>{let f=g=>(i.actions.forEach(b=>{if(g instanceof DragEvent&&(g.data=Rn(g)),g instanceof ClipboardEvent)try{g.data=Array.from(g.clipboardData?.items??[]).reduce((A,S)=>{try{A[S.type]=JSON.parse(g.clipboardData?.getData(S.type))}catch{A[S.type]=g.clipboardData?.getData(S.type)}return A},{})}catch(A){console.error("Could not get paste data"),console.error(A)}I(b,{...t.get(),Event:g},n,g)}),!1);d.addEventListener(i.trigger,f)});let E=e.tag.toLocaleLowerCase();if(E==="script"||E==="style"){let i=[];e.children.map(f=>n.component.nodes[f]).filter(f=>f?.type==="text").forEach(f=>{if(f.value.type==="value")i.push(String(f.value.value));else{let g=t.map(b=>String((0,be.applyFormula)(f.value,{data:b,component:n.component,formulaCache:n.formulaCache,root:n.root,package:n.package,toddle:n.toddle,env:n.env})));i.push(g)}}),i.every(f=>typeof f=="string")&&(d.textContent=i.join("")),i.filter(f=>typeof f!="string").forEach(f=>{f.subscribe(()=>{d.textContent=i.map(g=>typeof g=="string"?g:g.get()).join("")})})}else e.children.forEach((i,f)=>{le({parentElement:d,id:i,path:o+"."+f,dataSignal:t,ctx:n,namespace:a,instance:s}).forEach(b=>d.appendChild(b))});return d}function Pn({path:e,node:t,dataSignal:r,ctx:o,parentElement:n,instance:a,namespace:s}){let l=t.name??"default",d=[];if(o.children[l]?d=o.children[l].flatMap(m=>{let E=m.dataSignal.map(i=>i);return r.subscribe(i=>i,{destroy:()=>E.destroy()}),le({...m,dataSignal:E,parentElement:n,ctx:{...m.ctx,providers:o.providers},instance:a,namespace:s})}):d=t.children.flatMap((m,E)=>le({id:m,path:e+"."+E,dataSignal:r,ctx:o,parentElement:n,instance:a,namespace:s})),o.env.runtime==="custom-element"&&o.isRootComponent){let m=document.createElement("slot");return m.setAttribute("name",l),d.forEach(E=>{m.appendChild(E)}),[m]}return d}var So=j(B());function In({node:e,id:t,path:r,dataSignal:o,namespace:n,ctx:a}){if(n&&n!=="http://www.w3.org/1999/xhtml")return jd({node:e,dataSignal:o,ctx:a});let{value:s}=e,l=document.createElement("span");return l.setAttribute("data-node-id",t),typeof t=="string"&&l.setAttribute("data-id",r),a.isRootComponent===!1&&l.setAttribute("data-component",a.component.name),l.setAttribute("data-node-type","text"),s.type!=="value"?o.map(m=>String((0,So.applyFormula)(s,{data:m,component:a.component,formulaCache:a.formulaCache,root:a.root,package:a.package,toddle:a.toddle,env:a.env}))).subscribe(m=>{l.innerText=m}):l.innerText=String(s.value),l}function jd({node:e,dataSignal:t,ctx:r}){let{value:o}=e,n=document.createTextNode("");return o.type!=="value"?t.map(s=>String((0,So.applyFormula)(o,{data:s,component:r.component,formulaCache:r.formulaCache,root:r.root,package:r.package,toddle:r.toddle,env:r.env}))).subscribe(s=>{n.nodeValue=s}):n.nodeValue=String(o.value),n}function le({id:e,dataSignal:t,path:r,ctx:o,namespace:n,parentElement:a,instance:s}){let l=o.component.nodes[e];if(!l)return[];let d=({node:i,...f})=>{switch(i.type){case"element":return[Nn({node:i,...f})];case"component":let g=o.components.some(b=>b.name===i.name);return Dn({node:{...i,id:e},...f,ctx:{...o,package:i.package??(g?void 0:o.package)},parentElement:a});case"text":return[In({...f,node:i})];case"slot":return Pn({...f,node:i})}};function m({node:i,dataSignal:f,id:g,path:b,ctx:A,namespace:S,parentElement:v,instance:w}){let O=!0,F=null,c=f.map(y=>(0,$n.toBoolean)((0,Je.applyFormula)(i.condition,{data:y,component:A.component,formulaCache:A.formulaCache,root:A.root,package:A.package,toddle:A.toddle,env:A.env}))),u=[],C=y=>{if(y&&u.length===0){if(F?.destroy(),F=f.map(T=>T),u.push(...d({node:i,dataSignal:F,path:b,id:g,ctx:A,namespace:S,parentElement:v,instance:w})),O)return;if(!v||A.root.contains(v)===!1){console.error(`Conditional: Parent element does not exist for "${b}" This is likely due to the DOM being modified outside of toddle.`);return}if(v.querySelector(`[data-id="${b}"]`)){console.warn(`Conditional: Element with data-id="${b}" already exists. This is likely due to the DOM being modified outside of toddle`);return}let h=Ao(b,v);for(let T of u)v.insertBefore(T,h)}else y||(F?.destroy(),u.forEach(h=>h.remove()),u.splice(0,u.length))};return c.subscribe(C,{destroy:()=>{F?.destroy()}}),A.env.runtime==="preview"&&A.toddle._preview&&A.toddle._preview.showSignal.subscribe(({displayedNodes:y,testMode:h})=>{y.includes(b)&&!h?C(!0):C(c.get())}),O=!1,u}function E(){let i=!0,f=new Map;return t.map(b=>{let A=(0,Je.applyFormula)(l.repeat,{data:b,component:o.component,formulaCache:o.formulaCache,root:o.root,package:o.package,toddle:o.toddle,env:o.env});return typeof A!="object"?[]:Object.entries(A??{})}).subscribe(b=>{let A=new Map;for(let S=0;S<b.length;S++){let[v,w]=b[S],O={...t.get(),ListItem:{...t.get().ListItem?{Parent:t.get().ListItem}:{},Item:w,Index:Number(S),Key:v}},F=l.repeatKey?(0,Je.applyFormula)(l.repeatKey,{data:O,component:o.component,formulaCache:o.formulaCache,root:o.root,package:o.package,toddle:o.toddle,env:o.env}):v;A.has(F)&&(console.warn(`Duplicate key "${F}" found in repeat. Fallback to index as key. This will cause a re-render of the duplicated children on every change.`),F=v);let c=f.get(F);if(c)A.set(F,c),c.dataSignal.update(u=>({...u,ListItem:{...t.get().ListItem?{Parent:t.get().ListItem}:{},Item:w,Index:Number(S),Key:v}}));else{let u=oe(O),C=t.subscribe(T=>{i||u.update(({ListItem:$})=>({...T,ListItem:$}))},{destroy:()=>u.destroy()}),y={node:l,id:e,dataSignal:u,path:v==="0"?r:`${r}(${v})`,ctx:o,namespace:n,parentElement:a,instance:s},h=l.condition?m(y):d(y);A.set(F,{dataSignal:u,cleanup:C,elements:h})}}if(Array.from(f.entries()).forEach(([S,v])=>{A.has(S)||(v.cleanup(),v.dataSignal.destroy(),v.elements.forEach(w=>w.remove()))}),f=A,!(i||f.size===0)){if(!a||o.root.contains(a)===!1){console.error(`Repeat: Parent element does not exist for ${r}. This is likely due to the DOM being modified outside of toddle.`);return}Fn(a,Array.from(f.values()).flatMap(S=>S.elements),Ao(r,a))}},{destroy:()=>Array.from(f.values()).forEach(b=>{b.cleanup(),b.dataSignal.destroy(),b.elements.forEach(A=>A.remove())})}),i=!1,Array.from(f.values()).flatMap(b=>b.elements)}return l.repeat?E():l.condition?m({node:l,dataSignal:t,ctx:o,id:e,path:r,namespace:n,parentElement:a,instance:s}):d({node:l,dataSignal:t,ctx:o,id:e,path:r,namespace:n,parentElement:a,instance:s})}var Od=new qe;function He({component:e,dataSignal:t,onEvent:r,isRootComponent:o,path:n,children:a,formulaCache:s,components:l,apis:d,abortSignal:m,root:E,providers:i,package:f,parentElement:g,instance:b,toddle:A,namespace:S,env:v}){let w={triggerEvent:r,component:e,components:l,dataSignal:t,isRootComponent:o,apis:d,formulaCache:s,children:a,abortSignal:m,root:E,providers:i,package:f,toddle:A,env:v},O=le({id:"root",path:n,dataSignal:t,ctx:w,parentElement:g,namespace:S,instance:b});return Od.add(()=>{let F;e.onAttributeChange?.actions&&e.onAttributeChange.actions.length>0&&t.map(c=>c.Attributes).subscribe(c=>{F&&e.onAttributeChange?.actions.forEach(u=>{I(u,t.get(),w,new CustomEvent("attribute-change",{detail:Object.entries(c).reduce((C,[y,h])=>((0,Ln.default)(h,F[y])===!1&&e.attributes[y]?.name&&(C[e.attributes[y]?.name]={current:F[y],new:h}),C),{})}))}),F=c}),e.onLoad?.actions.forEach(c=>{I(c,t.get(),w)})}),O}var ze=class extends HTMLElement{toddle;#r;#e;#o;#t;#n;constructor(t,r,o){super(),this.toddle=o;let n=this.attachInternals();n.shadowRoot?this.#o=n.shadowRoot:this.#o=this.attachShadow({mode:"open"});let a={branchName:o.branch||"main",isServer:!1,request:void 0,runtime:"custom-element",logErrors:!0};this.#r=t,this.#t=kd({component:t,root:this.#o,toddle:o,env:a}),this.#n={themes:r.themes};let s=new AbortController;this.#t.subscribe(()=>{},{destroy:()=>s.abort(`Component ${t.name} unmounted`)}),this.#e={triggerEvent:this.dispatch.bind(this),root:this.#o,isRootComponent:!0,components:r.components,component:this.#r,dataSignal:this.#t,formulaCache:{},apis:{},abortSignal:s.signal,children:{},providers:{},package:void 0,toddle:o,env:a}}connectedCallback(){(0,Ge.sortApiObjects)(Object.entries(this.#r.apis)).forEach(([r,o])=>{(0,Ge.isLegacyApi)(o)?this.#e.apis[r]=Ie(o,this.#e):this.#e.apis[r]=_e(o,this.#e)}),Object.values(this.#e.apis).filter(r=>r.triggerActions!==void 0).forEach(r=>{r.triggerActions()});let t=this.#e.providers;if(Me(this.#r)){let r=Object.fromEntries(Object.entries(this.#r.formulas??{}).filter(([,o])=>o.exposeInContext).map(([o,n])=>[o,this.#t.map(a=>(0,wo.applyFormula)(n.formula,{data:a,component:this.#r,formulaCache:this.#e.formulaCache,root:this.#e.root,package:this.#e.package,toddle:this.#e.toddle,env:this.#e.env}))]));t={...t,[this.#r.name]:{component:this.#r,formulaDataSignals:r,ctx:this.#e}}}this.#e.providers=t,this.render()}disconnectedCallback(){this.#t.destroy()}dispatch(t,r){this.dispatchEvent(new CustomEvent(t,{detail:r,bubbles:!0,composed:!0}))}render(){let t=He({...this.#e,path:"0",onEvent:this.dispatch.bind(this),parentElement:this.#o,instance:{[this.#r.name]:"root"}});this.#o.innerHTML="";let r=(0,_n.createStylesheet)(this.#e.component,this.#e.components,this.#n.themes?Object.values(this.#n.themes)[0]:qn.theme,{includeResetStyle:!0,createFontFaces:!1}),o=document.createElement("style");o.appendChild(document.createTextNode(r)),this.#o.appendChild(o);let n=t[0];n&&this.#o.appendChild(n)}setAttribute(t,r){switch(typeof r){case"number":super.setAttribute(t,String(r));break;case"string":return super.setAttribute(t,r),this;default:super.setAttribute(t,`[Object ${typeof r}]`);break}return this.#t.set({...this.#t.get(),Attributes:{...this.#t.get().Attributes,[t]:r}}),this}getAttribute(t){return this.#t.get().Attributes[t]||super.getAttribute(t)}attributeChangedCallback(t,r,o){let n=this.getAttributeCaseInsensitive(t),a=this.getAttribute(n);o!=="[Object object]"&&parseFloat(o)!==a&&this.#t.set({...this.#t.get(),Attributes:{...this.#t.get().Attributes,[n]:o}})}getAttributeCaseInsensitive(t){let r=Object.keys(this.#t.get().Attributes).find(o=>o.toLowerCase()===t.toLowerCase());if(!r)throw new Error(`Unable to find attribute ${t} on component ${this.#r.name}`);return r}get __component(){return this.#r}get __ctx(){return this.#e}get __signal(){return this.#t}},kd=({component:e,root:t,toddle:r,env:o})=>oe({Location:void 0,Variables:(0,We.mapObject)(e.variables,([n,{initialValue:a}])=>{if(!e)throw new Error("Component not found");return[n,(0,wo.applyFormula)(a,{data:{Attributes:{}},component:e,root:t,package:void 0,toddle:r,env:o})]}),Attributes:(0,We.mapObject)(e.attributes,([n])=>[n,void 0]),Apis:(0,We.mapObject)(e.apis,([n])=>[n,{data:null,isLoading:!1,error:null}])});var Dd=(e,t,r)=>{e.map(o=>t.components.find(n=>n.name===o)).forEach(o=>{let n=(0,Mn.safeCustomElementName)(o.name);if(customElements.get(n)){console.warn(`Component ${n} already defined`);return}customElements.define(n,class extends ze{constructor(){super(o,t,r)}static get observedAttributes(){return Object.keys(o.attributes??{}).map(a=>a.toLowerCase())}})})};var ep=(e=window.toddle)=>{e.isEqual=Bn.default,Object.entries(io).forEach(([t,r])=>e.registerFormula("@toddle/"+t,r.default,"getArgumentInputData"in r?r.getArgumentInputData:void 0)),Object.entries(gt).forEach(([t,r])=>e.registerAction("@toddle/"+t,r.default))};export{Dd as defineComponents,ep as loadCorePlugins};
//# sourceMappingURL=esm-custom-element.main.js.map
